import{d as ge,r as n,w as te,b4 as qe,o as y,h as A,f as o,b as l,p as a,aI as r,a$ as Fe,a4 as U,x as g,aM as ue,b6 as de,R as Y,c as Z,e as f,A as me,K as pe,y as E,a9 as ce,t as Re,F as Me,b2 as fe,a as Le,b3 as ve}from"./index-5caaa453.js";import{_ as je}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-9e7a34d5.js";import{_ as ze}from"./AppSelect.vue_vue_type_script_setup_true_lang-67ce80f3.js";import{_ as Xe}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-56955411.js";import{_ as He}from"./AppAutocomplete.vue_vue_type_script_setup_true_lang-2f5f92ce.js";import{_ as we}from"./AppTextField.vue_vue_type_script_setup_true_lang-298ad98d.js";import{r as ee}from"./validators-db74a876.js";import{_ as Ke}from"./AppDrawerHeaderSection.vue_vue_type_script_setup_true_lang-be308735.js";import{l as Qe}from"./lodash-eae677c1.js";import{P as Ge}from"./vue3-perfect-scrollbar.esm-ba9c318d.js";import{$ as ae}from"./api-44dd0fa9.js";import{V as O}from"./VCard-1a5b2c5e.js";import{V as T}from"./VCardText-3b4da816.js";import{V as Je}from"./VForm-ed4803d2.js";import{V as _e}from"./VRow-e44df108.js";import{V as N}from"./VCol-bcc5388c.js";import{V as We}from"./VNavigationDrawer-edab2f77.js";import{p as Ye}from"./paginationMeta-4ad053a4.js";import{F as Ze}from"./FileSaver.min-162ac943.js";import{X as L}from"./xlsx-d63df831.js";import{u as Ve}from"./useApi-c9327355.js";import{c as ke}from"./createUrl-3e678c2b.js";import{V as be}from"./VDivider-d40713ce.js";import{V as et}from"./VDataTableServer-64dc84b4.js";import{V as tt}from"./VChip-49676f7d.js";import{V as at}from"./VPagination-4169e3c5.js";import{V as ye}from"./VSnackbar-ea7773d7.js";import{V as lt}from"./VDialog-808ce03e.js";import"./form-c9c578a3.js";import"./VSelect-f0a443ce.js";import"./VTextField-604d91ff.js";/* empty css                   */import"./VCounter-728f7f8c.js";import"./transition-1886cce0.js";import"./VField-6b3808ed.js";import"./easing-9f15041e.js";import"./VInput-e87890b4.js";import"./forwardRefs-8348545e.js";import"./index-7dd1f5f0.js";import"./VList-4b1bf96e.js";import"./ssrBoot-2696bccc.js";import"./createSimpleFunctional-9624028d.js";import"./VAvatar-3ee4c690.js";import"./VImg-6009f8f0.js";import"./dialog-transition-1ae6ec72.js";import"./VMenu-97c48b4e.js";import"./VOverlay-da001e16.js";import"./lazy-9cd674a5.js";import"./scopeId-484eb469.js";import"./VCheckboxBtn-1d552264.js";import"./VSelectionControl-e0df1dbd.js";import"./filter-aecd5fc1.js";import"./helpers-681711bc.js";import"./VSpacer-a56288e5.js";import"./index-2898f57d.js";/* empty css              */import"./VDataTable-1493872b.js";import"./VTable-f9bab7db.js";const ot=[{title:"ID",key:"id"},{title:"Name",key:"name"},{title:"URL",key:"url"},{title:"email",key:"email"},{title:"Contact Person",key:"contact_person"},{title:"Date",key:"created_at",sortable:!1},{title:"Status",key:"status",sortable:!1},{title:"Action",key:"actions",sortable:!1}],st=ge({__name:"NewBank",props:{isDrawerOpen:{type:Boolean}},emits:["update:isDrawerOpen","userData"],setup(le,{emit:v}){const B=le,V=v,w=n({message:void 0,statusCode:void 0}),q=n(),j=n(!0);te(q,()=>{j.value=!q.value[0]});const z=qe("userData"),S=n(!1),m=n(),_=n(""),p=n(""),$=n(""),F=Qe.debounce(async u=>{try{const{exists:i}=await ae("/UI/bank/email/check",{method:"POST",query:{emailNew:u}});console.log("Testing email response",i),i?w.value.message="Email already exists.":w.value.message=""}catch(i){console.error("Error checking email:",i),w.value.message="Error checking email."}},500),C=()=>{V("update:isDrawerOpen",!1),ue(()=>{var u,i;(u=m.value)==null||u.reset(),(i=m.value)==null||i.resetValidation()})},k=()=>{var u;(u=m.value)==null||u.validate().then(({valid:i})=>{i&&(V("userData",{name:_.value,url:$.value,email:p.value,createdBy:z.value.id}),V("update:isDrawerOpen",!1),ue(()=>{var d,x;(d=m.value)==null||d.reset(),(x=m.value)==null||x.resetValidation()}))})},b=u=>{V("update:isDrawerOpen",u)};return te(()=>p.value,u=>{w.value.message="",u&&F(u)}),(u,i)=>{const d=Ke,x=we;return y(),A(We,{"model-value":B.isDrawerOpen,width:400,class:"scrollable-content",location:"end",temporary:"","onUpdate:modelValue":b},{default:o(()=>[l(d,{title:"New Bank",onCancel:C}),l(a(Ge),{options:{wheelPropagation:!1}},{default:o(()=>[l(O,{flat:""},{default:o(()=>[l(T,null,{default:o(()=>[l(a(Je),{ref_key:"refForm",ref:m,modelValue:a(S),"onUpdate:modelValue":i[4]||(i[4]=c=>r(S)?S.value=c:null),onSubmit:Fe(k,["prevent"])},{default:o(()=>[l(_e,null,{default:o(()=>[l(N,{cols:"12"},{default:o(()=>[l(x,{modelValue:a(_),"onUpdate:modelValue":i[0]||(i[0]=c=>r(_)?_.value=c:null),rules:["requiredValidator"in u?u.requiredValidator:a(ee)],label:"Bank Name",placeholder:"Bank Name"},null,8,["modelValue","rules"])]),_:1}),l(N,{cols:"12"},{default:o(()=>[l(x,{modelValue:a($),"onUpdate:modelValue":i[1]||(i[1]=c=>r($)?$.value=c:null),rules:["requiredValidator"in u?u.requiredValidator:a(ee)],label:"Bank URL",placeholder:"Bank URL"},null,8,["modelValue","rules"])]),_:1}),l(N,{cols:"12"},{default:o(()=>[l(x,{modelValue:a(p),"onUpdate:modelValue":i[2]||(i[2]=c=>r(p)?p.value=c:null),"error-messages":a(w).message,rules:["requiredValidator"in u?u.requiredValidator:a(ee)],label:"Bank Email",placeholder:"bank@yofinvoice.com",type:"email",onChange:i[3]||(i[3]=c=>a(F)(a(p)))},null,8,["modelValue","error-messages","rules"])]),_:1}),l(N,{cols:"12"},{default:o(()=>[l(U,{class:"me-3",type:"submit"},{default:o(()=>[g(" Submit ")]),_:1}),l(U,{color:"secondary",type:"reset",variant:"outlined",onClick:C},{default:o(()=>[g(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}}),nt=f("h4",{class:"text-h4 text-high-emphasis mb-1"}," Bank Management ",-1),it={class:"d-flex flex-wrap gap-4 mx-5"},rt={class:"d-flex align-center"},ut={class:"d-flex gap-4 flex-wrap align-center"},dt={key:0},mt={key:1},pt={class:"d-flex align-center justify-sm-space-between justify-center flex-wrap gap-3 pa-5 pt-3"},ct={class:"text-sm text-disabled mb-0"},ft=f("br",null,null,-1),vt=f("br",null,null,-1),_a=ge({__name:"banks",async setup(le){let v,B;const V=n(""),w=n(!0),q=n(0),j=n(),z=n(),S=n(),m=n(),_=n(),p=n();n([]);const $=fe(()=>ve(()=>import("./NewContact-0e5b7d90.js"),["assets/NewContact-0e5b7d90.js","assets/validators-db74a876.js","assets/helpers-681711bc.js","assets/index-5caaa453.js","assets/index-c76bff88.css","assets/AppSelect.vue_vue_type_script_setup_true_lang-67ce80f3.js","assets/form-c9c578a3.js","assets/form-16aeed72.css","assets/VSelect-f0a443ce.js","assets/VTextField-604d91ff.js","assets/VCounter-728f7f8c.js","assets/transition-1886cce0.js","assets/VCounter-66d880d8.css","assets/VField-6b3808ed.js","assets/easing-9f15041e.js","assets/VField-f0ae27e6.css","assets/VInput-e87890b4.js","assets/VInput-aff17aa7.css","assets/forwardRefs-8348545e.js","assets/index-7dd1f5f0.js","assets/VTextField-72d54917.css","assets/VList-4b1bf96e.js","assets/ssrBoot-2696bccc.js","assets/createSimpleFunctional-9624028d.js","assets/VAvatar-3ee4c690.js","assets/VImg-6009f8f0.js","assets/VImg-b8589eee.css","assets/VAvatar-0c2eeb2f.css","assets/VDivider-d40713ce.js","assets/VDivider-357e019d.css","assets/VList-124a256e.css","assets/dialog-transition-1ae6ec72.js","assets/VMenu-97c48b4e.js","assets/VOverlay-da001e16.js","assets/lazy-9cd674a5.js","assets/scopeId-484eb469.js","assets/VOverlay-3a294b3a.css","assets/VMenu-fe9a8434.css","assets/VCheckboxBtn-1d552264.js","assets/VSelectionControl-e0df1dbd.js","assets/VSelectionControl-3bc768c3.css","assets/VChip-49676f7d.js","assets/VChip-615f71d7.css","assets/VSelect-055dcab5.css","assets/AppTextField.vue_vue_type_script_setup_true_lang-298ad98d.js","assets/DialogCloseBtn.vue_vue_type_script_setup_true_lang-9e7a34d5.js","assets/VCard-1a5b2c5e.js","assets/VCardText-3b4da816.js","assets/VCard-948d992c.css","assets/VForm-ed4803d2.js","assets/VRow-e44df108.js","assets/VGrid-a2928905.css","assets/VCol-bcc5388c.js","assets/VDialog-808ce03e.js","assets/VDialog-94321bd4.css"])),F=fe(()=>ve(()=>import("./AssociatedContact-734de843.js"),["assets/AssociatedContact-734de843.js","assets/AppAutocomplete.vue_vue_type_script_setup_true_lang-2f5f92ce.js","assets/form-c9c578a3.js","assets/index-5caaa453.js","assets/index-c76bff88.css","assets/form-16aeed72.css","assets/VSelect-f0a443ce.js","assets/VTextField-604d91ff.js","assets/VCounter-728f7f8c.js","assets/transition-1886cce0.js","assets/VCounter-66d880d8.css","assets/VField-6b3808ed.js","assets/easing-9f15041e.js","assets/VField-f0ae27e6.css","assets/VInput-e87890b4.js","assets/VInput-aff17aa7.css","assets/forwardRefs-8348545e.js","assets/index-7dd1f5f0.js","assets/VTextField-72d54917.css","assets/VList-4b1bf96e.js","assets/ssrBoot-2696bccc.js","assets/createSimpleFunctional-9624028d.js","assets/VAvatar-3ee4c690.js","assets/VImg-6009f8f0.js","assets/VImg-b8589eee.css","assets/VAvatar-0c2eeb2f.css","assets/VDivider-d40713ce.js","assets/VDivider-357e019d.css","assets/VList-124a256e.css","assets/dialog-transition-1ae6ec72.js","assets/VMenu-97c48b4e.js","assets/VOverlay-da001e16.js","assets/lazy-9cd674a5.js","assets/scopeId-484eb469.js","assets/VOverlay-3a294b3a.css","assets/VMenu-fe9a8434.css","assets/VCheckboxBtn-1d552264.js","assets/VSelectionControl-e0df1dbd.js","assets/VSelectionControl-3bc768c3.css","assets/VChip-49676f7d.js","assets/VChip-615f71d7.css","assets/VSelect-055dcab5.css","assets/filter-aecd5fc1.js","assets/AppAutocomplete-fb540f4c.css","assets/DialogCloseBtn.vue_vue_type_script_setup_true_lang-9e7a34d5.js","assets/useApi-c9327355.js","assets/createUrl-3e678c2b.js","assets/index-2898f57d.js","assets/api-44dd0fa9.js","assets/VCard-1a5b2c5e.js","assets/VCardText-3b4da816.js","assets/VCard-948d992c.css","assets/VDialog-808ce03e.js","assets/VDialog-94321bd4.css","assets/AssociatedContact-16a55cc5.css"])),C=n(!1),k=n(!1),b=n(null),u=s=>{b.value=s,k.value=!0},i=n(10),d=n(1),x=n(),c=n(),I=n([]),Ce=s=>{var t,h;d.value=s.page,x.value=(t=s.sortBy[0])==null?void 0:t.key,c.value=(h=s.sortBy[0])==null?void 0:h.order},xe=()=>{w.value=!w.value},De=()=>{V.value=""},Ae=()=>{q.value=0},Ue=()=>{Ae(),De()},{data:oe,execute:R}=([v,B]=de(()=>Ve(ke("/UI/get/banks",{query:{q:V,user_id:_,status:S,date:p,plan:z,role:j,itemsPerPage:i,page:d,sortBy:x,orderBy:c}}))),v=await v,B(),v),X=Y(()=>oe.value.data);console.log(X.value);const M=Y(()=>oe.value.total),H=n(!1),Be=async s=>{await ae("/UI/new/bank",{method:"POST",body:s}),await R()};R();const K=n(!1),Q=n(!1),D=n(!1),P=n(0),$e=async s=>{try{console.log(s)}catch(t){console.error(t)}},se=s=>s&&s==="active"?{color:"success",icon:"tabler-thumb-up"}:{color:"error",icon:"tabler-thumb-down"},Pe=async()=>{D.value=!D.value,await R()},{data:G,execute:Vt}=([v,B]=de(()=>Ve(ke("/users/UI/list"))),v=await v,B(),v),he=Y(()=>!G.value||!G.value.users?[]:G.value.users),Ne=n([{title:"Activate",value:"active"},{title:"Deactivate",value:"inactive"}]),J=async s=>{await ae("/UI/banks/activate",{method:"POST",body:{ids:s,status:m.value}}),k.value=!1,await R()};te(m,s=>{s&&I.value.length&&J(I.value)});const Se=s=>{if(s==="active")return{text:"Active",color:"success"};if(s==="inactive")return{text:"Inactive",color:"info"};if(s==="pending_checker")return{text:"Pending Checker Approval",color:"info"};if(s==="suspended")return{text:"Suspended",color:"error"}},Ie=()=>{const s=L.utils.json_to_sheet(X.value),t=L.utils.book_new();L.utils.book_append_sheet(t,s,"Banks");const h=L.write(t,{bookType:"xlsx",type:"array"});Ze.saveAs(new Blob([h],{type:"application/octet-stream"}),"Banks.xlsx")};return(s,t)=>{const h=we,Ee=He,Oe=Xe,ne=ze,ie=Le("IconBtn"),Te=je;return y(),Z(Me,null,[f("section",null,[nt,l(O,null,{default:o(()=>[l(T,{class:"py-4 gap-4"},{default:o(()=>[f("div",it,[l(_e,null,{default:o(()=>[l(N,{cols:"12",md:"9"},{default:o(()=>[f("div",rt,[l(h,{modelValue:a(V),"onUpdate:modelValue":t[0]||(t[0]=e=>r(V)?V.value=e:null),"append-inner-icon":a(w)?"tabler-search":"tabler-map-pin-off",class:"me-3","clear-icon":"tabler-circle-x",clearable:"",color:"primary",placeholder:"Search Bank",type:"text","onClick:appendInner":xe,"onClick:append":Ue},null,8,["modelValue","append-inner-icon"]),l(Ee,{modelValue:a(_),"onUpdate:modelValue":t[1]||(t[1]=e=>r(_)?_.value=e:null),"item-title":e=>e.fullName,"item-value":e=>e.id,items:a(he),class:"me-3",placeholder:"Contact Person",style:{"inline-size":"200px"}},null,8,["modelValue","item-title","item-value","items"]),l(Oe,{modelValue:a(p),"onUpdate:modelValue":t[2]||(t[2]=e=>r(p)?p.value=e:null),class:"me-3","clear-icon":"tabler-x",clearable:"",placeholder:"Select Date",style:{"inline-size":"200px"}},null,8,["modelValue"]),s.$can("manage","Banks Checker")&&s.$can("manage","Banks Bulk Approve")?(y(),A(ne,{key:0,modelValue:a(m),"onUpdate:modelValue":t[3]||(t[3]=e=>r(m)?m.value=e:null),items:a(Ne),"item-title":"title","item-value":"value",class:"me-1","clear-icon":"tabler-x",clearable:"",chips:"",placeholder:"Bulk Actions",style:{"inline-size":"200px"}},null,8,["modelValue","items"])):me("",!0)])]),_:1}),l(N,{cols:"12",md:"3"},{default:o(()=>[f("div",ut,[l(ne,{modelValue:a(i),"onUpdate:modelValue":t[4]||(t[4]=e=>r(i)?i.value=e:null),items:[5,10,20,25,50]},null,8,["modelValue"]),l(U,{color:"primary","prepend-icon":"tabler-download",style:{"text-size-adjust":"auto","text-transform":"none"},onClick:Ie}),s.$can("manage","Banks Maker")?(y(),A(U,{key:0,"prepend-icon":"tabler-plus",onClick:t[5]||(t[5]=e=>s.$router.push("/bank/new"))},{default:o(()=>[g(" Add New Bank ")]),_:1})):me("",!0)])]),_:1})]),_:1})])]),_:1}),l(be),l(a(et),{modelValue:a(I),"onUpdate:modelValue":t[7]||(t[7]=e=>r(I)?I.value=e:null),"items-per-page":a(i),"onUpdate:itemsPerPage":t[8]||(t[8]=e=>r(i)?i.value=e:null),page:a(d),"onUpdate:page":t[9]||(t[9]=e=>r(d)?d.value=e:null),headers:a(ot),items:a(X),"items-length":a(M),class:"text-no-wrap","show-select":"","onUpdate:options":Ce},{"item.amount":o(({item:e})=>[f("span",{style:pe({color:`${s.$vuetify.theme.global.current.colors.success}`})},E(e.amount),5)]),"item.url":o(({item:e})=>[f("span",{style:pe({color:`${s.$vuetify.theme.global.current.colors.success}`})},E(e.url),5)]),"item.actions":o(({item:e})=>[s.$can("manage","Banks Checker")?(y(),Z("div",dt,[l(ie,null,{default:o(()=>[l(ce,{icon:"tabler-edit",onClick:W=>s.$router.push(`/bank/view/${e.id}`)},null,8,["onClick"])]),_:2},1024),l(ie,null,{default:o(()=>{var W,re;return[l(ce,{icon:(W=se(e.status))==null?void 0:W.icon,color:(re=se(e.status))==null?void 0:re.color,title:e.account_status,onClick:kt=>u([e])},null,8,["icon","color","title","onClick"])]}),_:2},1024)])):(y(),Z("p",mt," Insufficient Permissions "))]),"item.status":o(({item:e})=>[l(tt,Re({density:"default",label:""},Se(e.status)),null,16)]),bottom:o(()=>[l(be),f("div",pt,[f("p",ct,E(a(Ye)({page:a(d),itemsPerPage:a(i)},a(M))),1),l(at,{modelValue:a(d),"onUpdate:modelValue":t[6]||(t[6]=e=>r(d)?d.value=e:null),length:Math.ceil(a(M)/a(i)),"total-visible":s.$vuetify.display.xs?1:Math.ceil(a(M)/a(i))},null,8,["modelValue","length","total-visible"])])]),_:1},8,["modelValue","items-per-page","page","headers","items","items-length"])]),_:1}),l(st,{isDrawerOpen:a(H),"onUpdate:isDrawerOpen":t[10]||(t[10]=e=>r(H)?H.value=e:null),onUserData:Be},null,8,["isDrawerOpen"]),l(ye,{modelValue:a(D),"onUpdate:modelValue":t[11]||(t[11]=e=>r(D)?D.value=e:null),color:"success",location:"top end",variant:"flat"},{default:o(()=>[g(" New Contact Added Successfully ")]),_:1},8,["modelValue"]),l(ye,{modelValue:a(C),"onUpdate:modelValue":t[12]||(t[12]=e=>r(C)?C.value=e:null),color:"success",location:"top end",variant:"flat"},{default:o(()=>[g(" New Contact associated successfully ")]),_:1},8,["modelValue"]),l(O,{class:"text-high-emphasis text-center"},{default:o(()=>[l(a($),{isDialogVisible:a(K),"onUpdate:isDialogVisible":t[13]||(t[13]=e=>r(K)?K.value=e:null),isNewContactAdded:a(D),"onUpdate:isNewContactAdded":t[14]||(t[14]=e=>r(D)?D.value=e:null),pipeline:a(P),"onUpdate:pipeline":t[15]||(t[15]=e=>r(P)?P.value=e:null),onSubmit:$e},null,8,["isDialogVisible","isNewContactAdded","pipeline"])]),_:1}),l(O,{class:"text-high-emphasis text-center"},{default:o(()=>[l(a(F),{isContactAssociated:a(C),"onUpdate:isContactAssociated":t[16]||(t[16]=e=>r(C)?C.value=e:null),isDialogVisible:a(Q),"onUpdate:isDialogVisible":[t[17]||(t[17]=e=>r(Q)?Q.value=e:null),Pe],pipeline:a(P),"onUpdate:pipeline":t[18]||(t[18]=e=>r(P)?P.value=e:null)},null,8,["isContactAssociated","isDialogVisible","pipeline"])]),_:1})]),l(lt,{modelValue:a(k),"onUpdate:modelValue":t[23]||(t[23]=e=>r(k)?k.value=e:null),persistent:"",class:"v-dialog-sm"},{default:o(()=>[l(Te,{onClick:t[19]||(t[19]=e=>k.value=!a(k))}),l(O,null,{default:o(()=>[a(b)[0].status=="inactive"||a(b)[0].status=="pending_checker"?(y(),A(T,{key:0},{default:o(()=>[g(" Are you sure you want to activate bank: "+E(a(b)[0].name)+"? ",1),ft]),_:1})):(y(),A(T,{key:1},{default:o(()=>[g(" Are you sure you want to deactivate bank: "+E(a(b)[0].name)+"? ",1),vt]),_:1})),l(T,{class:"d-flex justify-end gap-3 flex-wrap"},{default:o(()=>[l(U,{color:"secondary",variant:"tonal",onClick:t[20]||(t[20]=e=>k.value=!1)},{default:o(()=>[g(" Cancel ")]),_:1}),a(b)[0].status=="inactive"?(y(),A(U,{key:0,color:"success",onClick:t[21]||(t[21]=e=>J([a(b)[0].id]))},{default:o(()=>[g(" Activate ")]),_:1})):(y(),A(U,{key:1,color:"error",onClick:t[22]||(t[22]=e=>J([a(b)[0].id]))},{default:o(()=>[g(" Deactivate ")]),_:1}))]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}});export{_a as default};
