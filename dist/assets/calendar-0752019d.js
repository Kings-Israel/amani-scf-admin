import{_ as W}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-544577ba.js";import{i as te,a as le,b as oe,c as ne,F as re}from"./index-8cb50ce0.js";import{r as O,u as se}from"./validators-db74a876.js";import{bi as de,d as K,r as k,w as $,R as I,o as P,h as U,f as s,b as l,L as q,M as J,p as e,a9 as ie,a$ as ue,e as x,y as pe,z as me,a4 as N,x as L,b8 as ce,ba as ve,b1 as fe,bj as Ve,bk as be,b9 as ge,aM as H,a as ye,ax as _e,I as Ce,c as G,aI as F,F as Ee,j as we,aR as De,aS as xe}from"./index-75b434bc.js";import{_ as Se}from"./AppTextarea.vue_vue_type_script_setup_true_lang-c557234d.js";import{_ as he}from"./AppSelect.vue_vue_type_script_setup_true_lang-32a0f469.js";import{_ as Pe}from"./AppTextField.vue_vue_type_script_setup_true_lang-93dc1e26.js";import{_ as ke}from"./AppDrawerHeaderSection.vue_vue_type_script_setup_true_lang-678f1b92.js";import{P as Te}from"./vue3-perfect-scrollbar.esm-4577c4a2.js";import{u as Oe}from"./useApi-776c55ea.js";import{c as Ue}from"./createUrl-149317bf.js";import{$ as B}from"./api-0c1dfdf3.js";import{V as M}from"./VCard-95c0d706.js";import{V as $e}from"./VCardText-76f31582.js";import{V as Ae}from"./VForm-e46f5921.js";import{V as Fe}from"./VRow-d6f20668.js";import{V as _}from"./VCol-35b3d337.js";import{V as Be}from"./VBadge-5a0d87a2.js";import{V as Ie}from"./VSwitch-84818870.js";import{V as Q}from"./VNavigationDrawer-0a767767.js";import{u as Ne,a as Le,V as Me}from"./VMain-696d1220.js";import{V as j}from"./VDivider-fc890531.js";import{V as z}from"./VCheckbox-e2d8e1ba.js";import{_ as Re}from"./_plugin-vue_export-helper-c27b6911.js";import"./VField-82993695.js";import"./form-2b416184.js";import"./easing-9f15041e.js";import"./VInput-b46333d7.js";import"./transition-6afda34e.js";import"./helpers-681711bc.js";import"./VTextarea-86010cd2.js";/* empty css                   */import"./VCounter-3e4b236e.js";import"./forwardRefs-8348545e.js";import"./index-97808f23.js";import"./VSelect-54e8b29a.js";import"./VTextField-05e93cc8.js";import"./VList-c7d4c8b4.js";import"./ssrBoot-7f224ca6.js";import"./createSimpleFunctional-4b3a0a39.js";import"./VAvatar-071125b9.js";import"./VImg-ba4b392a.js";import"./dialog-transition-14fdab67.js";import"./VMenu-3f143933.js";import"./VOverlay-0b79a00d.js";import"./lazy-0bb5e457.js";import"./scopeId-ee2feb8e.js";import"./VCheckboxBtn-0f22f589.js";import"./VSelectionControl-e1264669.js";import"./VChip-e2ddd660.js";import"./VSpacer-6f8dff92.js";import"./index-2898f57d.js";/* empty css              */const R=de("calendar",{state:()=>({availableCalendars:[{color:"error",label:"Personal"},{color:"primary",label:"Business"},{color:"warning",label:"Family"},{color:"success",label:"Holiday"},{color:"info",label:"ETC"}],selectedCalendars:["Personal","Business","Family","Holiday","ETC"]}),actions:{async fetchEvents(){const{data:i,error:p}=await Oe(Ue("/apps/calendar",{query:{calendars:this.selectedCalendars}}));return p.value?p.value:i.value},async addEvent(i){await B("/apps/calendar",{method:"POST",body:i})},async updateEvent(i){return await B(`/apps/calendar/${i.id}`,{method:"PUT",body:i})},async removeEvent(i){return await B(`/apps/calendar/${i}`,{method:"DELETE"})}}}),qe=K({__name:"CalendarEventHandler",props:{isDrawerOpen:{type:Boolean},event:{}},emits:["update:isDrawerOpen","addEvent","updateEvent","removeEvent"],setup(i,{emit:p}){const b=i,m=p,V=R(),g=k(),o=k(JSON.parse(JSON.stringify(b.event))),C=()=>{o.value=JSON.parse(JSON.stringify(b.event)),H(()=>{var a;(a=g.value)==null||a.resetValidation()})};$(()=>b.isDrawerOpen,C);const S=()=>{m("removeEvent",String(o.value.id)),m("update:isDrawerOpen",!1)},y=()=>{var a;(a=g.value)==null||a.validate().then(({valid:r})=>{r&&("id"in o.value?m("updateEvent",o.value):m("addEvent",o.value),m("update:isDrawerOpen",!1))})},T=[{avatar:ce,name:"Jane Foster"},{avatar:ve,name:"Donna Frank"},{avatar:fe,name:"Gabrielle Robertson"},{avatar:Ve,name:"Lori Spears"},{avatar:be,name:"Sandy Vega"},{avatar:ge,name:"Cheryl May"}],E=()=>{m("update:isDrawerOpen",!1),H(()=>{var a,r;(a=g.value)==null||a.reset(),C(),(r=g.value)==null||r.resetValidation()})},v=I(()=>{const a={enableTime:!o.value.allDay,dateFormat:`Y-m-d${o.value.allDay?"":" H:i"}`};return o.value.end&&(a.maxDate=o.value.end),a}),u=I(()=>{const a={enableTime:!o.value.allDay,dateFormat:`Y-m-d${o.value.allDay?"":" H:i"}`};return o.value.start&&(a.minDate=o.value.start),a}),w=a=>{m("update:isDrawerOpen",a)};return(a,r)=>{const A=ye("IconBtn"),t=ke,d=Pe,c=he,f=W,h=Se;return P(),U(Q,{temporary:"",location:"end","model-value":b.isDrawerOpen,width:"420",class:"scrollable-content","onUpdate:modelValue":w},{default:s(()=>[l(t,{title:e(o).id?"Update Event":"Add Event",onCancel:r[0]||(r[0]=n=>a.$emit("update:isDrawerOpen",!1))},{beforeClose:s(()=>[q(l(A,{onClick:S},{default:s(()=>[l(ie,{size:"18",icon:"tabler-trash"})]),_:1},512),[[J,e(o).id]])]),_:1},8,["title"]),l(e(Te),{options:{wheelPropagation:!1}},{default:s(()=>[l(M,{flat:""},{default:s(()=>[l($e,null,{default:s(()=>[l(e(Ae),{ref_key:"refForm",ref:g,onSubmit:ue(y,["prevent"])},{default:s(()=>[l(Fe,null,{default:s(()=>[l(_,{cols:"12"},{default:s(()=>[l(d,{modelValue:e(o).title,"onUpdate:modelValue":r[1]||(r[1]=n=>e(o).title=n),label:"Title",placeholder:"Meeting with Jane",rules:["requiredValidator"in a?a.requiredValidator:e(O)]},null,8,["modelValue","rules"])]),_:1}),l(_,{cols:"12"},{default:s(()=>[l(c,{modelValue:e(o).extendedProps.calendar,"onUpdate:modelValue":r[2]||(r[2]=n=>e(o).extendedProps.calendar=n),label:"Label",placeholder:"Select Event Label",rules:["requiredValidator"in a?a.requiredValidator:e(O)],items:e(V).availableCalendars,"item-title":n=>n.label,"item-value":n=>n.label},{selection:s(({item:n})=>[q(x("div",{class:me(["align-center",e(o).extendedProps.calendar?"d-flex":""])},[l(Be,{color:n.raw.color,inline:"",dot:"",class:"pa-1 pb-2"},null,8,["color"]),x("span",null,pe(n.raw.label),1)],2),[[J,e(o).extendedProps.calendar]])]),_:1},8,["modelValue","rules","items","item-title","item-value"])]),_:1}),l(_,{cols:"12"},{default:s(()=>[(P(),U(f,{key:JSON.stringify(e(v)),modelValue:e(o).start,"onUpdate:modelValue":r[3]||(r[3]=n=>e(o).start=n),rules:["requiredValidator"in a?a.requiredValidator:e(O)],label:"Start date",placeholder:"Select Date",config:e(v)},null,8,["modelValue","rules","config"]))]),_:1}),l(_,{cols:"12"},{default:s(()=>[(P(),U(f,{key:JSON.stringify(e(u)),modelValue:e(o).end,"onUpdate:modelValue":r[4]||(r[4]=n=>e(o).end=n),rules:["requiredValidator"in a?a.requiredValidator:e(O)],label:"End date",placeholder:"Select End Date",config:e(u)},null,8,["modelValue","rules","config"]))]),_:1}),l(_,{cols:"12"},{default:s(()=>[l(Ie,{modelValue:e(o).allDay,"onUpdate:modelValue":r[5]||(r[5]=n=>e(o).allDay=n),label:"All day"},null,8,["modelValue"])]),_:1}),l(_,{cols:"12"},{default:s(()=>[l(d,{modelValue:e(o).url,"onUpdate:modelValue":r[6]||(r[6]=n=>e(o).url=n),label:"Event URL",placeholder:"https://event.com/meeting",rules:["urlValidator"in a?a.urlValidator:e(se)],type:"url"},null,8,["modelValue","rules"])]),_:1}),l(_,{cols:"12"},{default:s(()=>[l(c,{modelValue:e(o).extendedProps.guests,"onUpdate:modelValue":r[7]||(r[7]=n=>e(o).extendedProps.guests=n),label:"Guests",placeholder:"Select guests",items:T,"item-title":n=>n.name,"item-value":n=>n.name,chips:"",multiple:"",eager:""},null,8,["modelValue","item-title","item-value"])]),_:1}),l(_,{cols:"12"},{default:s(()=>[l(d,{modelValue:e(o).extendedProps.location,"onUpdate:modelValue":r[8]||(r[8]=n=>e(o).extendedProps.location=n),label:"Location",placeholder:"Meeting room"},null,8,["modelValue"])]),_:1}),l(_,{cols:"12"},{default:s(()=>[l(h,{modelValue:e(o).extendedProps.description,"onUpdate:modelValue":r[9]||(r[9]=n=>e(o).extendedProps.description=n),label:"Description",placeholder:"Meeting description"},null,8,["modelValue"])]),_:1}),l(_,{cols:"12"},{default:s(()=>[l(N,{type:"submit",class:"me-3"},{default:s(()=>[L(" Submit ")]),_:1}),l(N,{variant:"outlined",color:"secondary",onClick:E},{default:s(()=>[L(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}}),Y={title:"",start:"",end:"",allDay:!1,url:"",extendedProps:{calendar:void 0,guests:[],location:"",description:""}},Je=(i,p,b)=>{const m=_e(),V=R(),g=k(),o={Business:"primary",Holiday:"success",Personal:"error",Family:"warning",ETC:"info"},C=t=>{const{id:d,title:c,start:f,end:h,url:n,extendedProps:{calendar:D,guests:X,location:Z,description:ee},allDay:ae}=t;return{id:d,title:c,start:f,end:h,url:n,extendedProps:{calendar:D,guests:X,location:Z,description:ee},allDay:ae}};typeof process<"u"&&process.server&&V.fetchEvents();const S=(t,d)=>{t&&V.fetchEvents().then(c=>{d(c.map(f=>({...f,start:new Date(f.start),end:new Date(f.end)})))}).catch(c=>{console.error("Error occurred while fetching calendar events",c)})},y=k(null),T=(t,d,c)=>{var h;const f=(h=y.value)==null?void 0:h.getEventById(String(t.id));if(!f){console.warn("Can't found event in calendar to update");return}for(let n=0;n<d.length;n++){const D=d[n];f.setProp(D,t[D])}f.setDates(t.start,t.end,{allDay:t.allDay});for(let n=0;n<c.length;n++){const D=c[n];f.setExtendedProp(D,t.extendedProps[D])}},E=t=>{var c;const d=(c=y.value)==null?void 0:c.getEventById(t);d&&d.remove()},v=()=>{var t;(t=y.value)==null||t.refetchEvents()};$(()=>V.selectedCalendars,v);const u=t=>{V.addEvent(t).then(()=>{v()})},w=t=>{V.updateEvent(t).then(d=>{T(d,["id","title","url"],["calendar","guests","location","description"])}),v()},a=t=>{V.removeEvent(t).then(()=>{E(t)})},r={plugins:[te,le,oe,ne],initialView:"dayGridMonth",headerToolbar:{start:"drawerToggler,prev,next title",end:"dayGridMonth,timeGridWeek,timeGridDay,listMonth"},events:S,forceEventDuration:!0,editable:!0,eventResizableFromStart:!0,dragScroll:!0,dayMaxEvents:2,navLinks:!0,eventClassNames({event:t}){const d=o[t._def.extendedProps.calendar];return[`bg-light-${d} text-${d}`]},eventClick({event:t}){i.value=C(t),p.value=!0},dateClick(t){i.value={...i.value,start:t.date},p.value=!0},eventDrop({event:t}){w(C(t))},eventResize({event:t}){t.start&&t.end&&w(C(t))},customButtons:{drawerToggler:{text:"calendarDrawerToggler",click(){b.value=!0}}}};Ce(()=>{y.value=g.value.getApi()});const A=t=>{var d;(d=y.value)==null||d.gotoDate(new Date(t))};return $(()=>m.isAppRTL,t=>{var d;(d=y.value)==null||d.setOption("direction",t?"rtl":"ltr")},{immediate:!0}),{refCalendar:g,calendarOptions:r,refetchEvents:v,fetchEvents:S,addEvent:u,updateEvent:w,removeEvent:a,jumpToDate:A}},He=i=>(De("data-v-b152a3b9"),i=i(),xe(),i),Ge={style:{margin:"1.4rem"}},je={class:"d-flex align-center justify-center pa-2 mb-3"},ze={class:"pa-7"},Ye=He(()=>x("p",{class:"text-sm text-uppercase text-disabled mb-3"}," FILTER ",-1)),We={class:"d-flex flex-column calendars-checkbox"},Ke=K({__name:"calendar",setup(i){const p=R(),b=k(structuredClone(Y)),m=k(!1);$(m,v=>{v||(b.value=structuredClone(Y))});const{isLeftSidebarOpen:V}=Ne(),{refCalendar:g,calendarOptions:o,addEvent:C,updateEvent:S,removeEvent:y,jumpToDate:T}=Je(b,m,V),E=I({get:()=>p.selectedCalendars.length===p.availableCalendars.length,set:v=>{v?p.selectedCalendars=p.availableCalendars.map(u=>u.label):p.selectedCalendars.length===p.availableCalendars.length&&(p.selectedCalendars=[])}});return(v,u)=>{const w=W;return P(),G("div",null,[l(M,null,{default:s(()=>[l(Le,{style:{"z-index":"0"}},{default:s(()=>[l(Q,{modelValue:e(V),"onUpdate:modelValue":u[4]||(u[4]=a=>F(V)?V.value=a:null),temporary:v.$vuetify.display.mdAndDown,absolute:"",class:"calendar-add-event-drawer",location:"start",touchless:"",width:"292"},{default:s(()=>[x("div",Ge,[l(N,{block:"","prepend-icon":"tabler-plus",onClick:u[0]||(u[0]=a=>m.value=!0)},{default:s(()=>[L(" Add event ")]),_:1})]),l(j),x("div",je,[l(w,{config:{inline:!0},"model-value":new Date().toJSON().slice(0,10),class:"calendar-date-picker",onInput:u[1]||(u[1]=a=>e(T)(a.target.value))},null,8,["model-value"])]),l(j),x("div",ze,[Ye,x("div",We,[l(z,{modelValue:e(E),"onUpdate:modelValue":u[2]||(u[2]=a=>F(E)?E.value=a:null),label:"View all"},null,8,["modelValue"]),(P(!0),G(Ee,null,we(e(p).availableCalendars,a=>(P(),U(z,{key:a.label,modelValue:e(p).selectedCalendars,"onUpdate:modelValue":u[3]||(u[3]=r=>e(p).selectedCalendars=r),color:a.color,label:a.label,value:a.label},null,8,["modelValue","color","label","value"]))),128))])])]),_:1},8,["modelValue","temporary"]),l(Me,null,{default:s(()=>[l(M,{flat:""},{default:s(()=>[l(e(re),{ref_key:"refCalendar",ref:g,options:e(o)},null,8,["options"])]),_:1})]),_:1})]),_:1})]),_:1}),l(qe,{id:v.pipelineID,isDrawerOpen:e(m),"onUpdate:isDrawerOpen":u[5]||(u[5]=a=>F(m)?m.value=a:null),event:e(b),onAddEvent:e(C),onUpdateEvent:e(S),onRemoveEvent:e(y)},null,8,["id","isDrawerOpen","event","onAddEvent","onUpdateEvent","onRemoveEvent"])])}}});const Ka=Re(Ke,[["__scopeId","data-v-b152a3b9"]]);export{Ka as default};
