import{_ as be}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-035125fd.js";import{_ as _e}from"./AddEditPermissionDialog.vue_vue_type_style_index_0_lang-8e135aae.js";import{_ as xe}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-544577ba.js";import{_ as Ce}from"./AppSelect.vue_vue_type_script_setup_true_lang-32a0f469.js";import{_ as De}from"./AppTextField.vue_vue_type_script_setup_true_lang-93dc1e26.js";import{p as ke}from"./paginationMeta-4ad053a4.js";import{i as V}from"./index-4532b75c.js";import{u as Z}from"./useApi-776c55ea.js";import{c as ee}from"./createUrl-149317bf.js";import{$ as te}from"./api-0c1dfdf3.js";import{V as oe}from"./VCol-35b3d337.js";import{V as F}from"./VCard-95c0d706.js";import{V as R}from"./VCardText-76f31582.js";import{d as we,r as i,b6 as le,R as $,I as Re,w as he,o as S,c as Pe,b as o,f as a,e as u,p as l,aI as n,a4 as b,x as c,y as h,t as Ae,h as M,a9 as O,A as q,F as $e,a as Se}from"./index-75b434bc.js";import{V as ae}from"./VDivider-fc890531.js";import{V as Te}from"./VDataTableServer-e9f6b4ac.js";import{V as Ue}from"./VChip-e2ddd660.js";import{V as je}from"./VPagination-2b54b87a.js";import{V as Ne}from"./VRow-d6f20668.js";import{V as se}from"./VDialog-bc06d443.js";import"./VForm-e46f5921.js";import"./form-2b416184.js";import"./forwardRefs-8348545e.js";import"./VAlert-1953529c.js";import"./createSimpleFunctional-4b3a0a39.js";import"./VField-82993695.js";import"./easing-9f15041e.js";import"./VInput-b46333d7.js";import"./transition-6afda34e.js";import"./VSelect-54e8b29a.js";import"./VTextField-05e93cc8.js";/* empty css                   */import"./VCounter-3e4b236e.js";import"./index-97808f23.js";import"./VList-c7d4c8b4.js";import"./ssrBoot-7f224ca6.js";import"./VAvatar-071125b9.js";import"./VImg-ba4b392a.js";import"./dialog-transition-14fdab67.js";import"./VMenu-3f143933.js";import"./VOverlay-0b79a00d.js";import"./lazy-0bb5e457.js";import"./scopeId-ee2feb8e.js";import"./VCheckboxBtn-0f22f589.js";import"./VSelectionControl-e1264669.js";import"./index-2898f57d.js";/* empty css              */import"./VDataTable-c3cccdda.js";import"./VTable-de2d1039.js";import"./filter-3bfef89c.js";const Be=u("h5",{class:"text-h4 mb-6"}," Roles List ",-1),Ie={class:"d-flex align-center gap-4 flex-wrap"},ze={cols:"12",md:"3"},Fe={cols:"12",md:"3"},Me={cols:"12",md:"3"},Oe={class:"d-flex align-center gap-4 flex-wrap"},qe={class:"d-flex align-center justify-space-between flex-wrap gap-3 pa-5 pt-3"},Ee={class:"text-sm text-medium-emphasis mb-0"},Je=u("br",null,null,-1),Le=u("br",null,null,-1),Jt=we({__name:"role",async setup(Ye){let f,P;const ie=[{title:"ID",key:"id",sortable:!1},{title:"Role",key:"RoleName",sortable:!1},{title:"Role Type",key:"RoleTypeName",sortable:!1},{title:"Role Description",key:"RoleDescription",sortable:!1},{title:"Created At",key:"created_at",sortable:!1},{title:"Total Permissions",key:"role_i_ds_count",sortable:!1},{title:"Status",key:"status",sortable:!1},{title:"Actions",key:"actions",sortable:!1}],E=i(""),_=i(null),J=i(null),x=i(""),C=i(null),D=i(""),k=i(null),p=i(50),m=i(1),re=i(),L=i(),Y=i(),v=i(!1),g=i(!1),T=i([]),{data:ne,execute:Ge}=([f,P]=le(()=>Z(ee("/UI/roles/permissions"))),f=await f,P(),f),U=$(()=>ne.value),j=i(),ue=s=>{var e,d;m.value=s.page,re.value=(e=s.sortBy[0])==null?void 0:e.key,L.value=(d=s.sortBy[0])==null?void 0:d.order},pe=s=>{_.value=s,v.value=!0},me=s=>{_.value=s,g.value=!0},de=i([{title:"Pending",value:"pending"},{title:"Approved",value:"approved"},{title:"Rejected",value:"rejected"}]),N=i(!1),B=i(!1),I=i(""),z=i(""),ce=$(()=>({q:E.value,roleType:j.value,status:J.value,createdAt:Y.value,page:m.value,itemsPerPage:p.value,orderBy:L.value})),{data:G,execute:y}=([f,P]=le(()=>Z(ee("/UI/all/roles/data",{query:ce}))),f=await f,P(),f),fe=$(()=>G.value.permissions),A=$(()=>G.value.totalPermissions);T.value=U.value.map(s=>s.name),Re(async()=>{await y(),T.value=U.value.map(s=>s.name),he(j,s=>{U.value.find(e=>e.name===s)},{immediate:!0})});const ve=s=>s==="approved"?{text:"Approved",color:"success"}:s==="pending"?{text:"Pending",color:"info"}:{text:"Rejected",color:"error"},ge=async s=>{var e,d;try{const r=await te("/post/role/approve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({role_id:s})});r.message==="Role approved successfully"?(V.success(r.message,{position:"top-right",autoClose:3e3}),await y(),v.value=!1):r.status===403?V.warn(r.message||"You cannot approve this role",{position:"top-right",autoClose:3e3}):V.error(r.message||"Something went wrong",{position:"top-right",autoClose:3e3})}catch(r){const w=((d=(e=r.response)==null?void 0:e.data)==null?void 0:d.message)||"Error approving the role";V.error(w,{position:"top-right",autoClose:3e3})}},ye=async s=>{var e,d;try{const r=await te("/post/role/reject",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({role_id:s})});r.message==="Role rejected successfully"?(V.success(r.message,{position:"top-right",autoClose:3e3}),await y(),g.value=!1):r.status===403?V.warn(r.message||"You cannot reject this role",{position:"top-right",autoClose:3e3}):V.error(r.message||"Something went wrong",{position:"top-right",autoClose:3e3})}catch(r){const w=((d=(e=r.response)==null?void 0:e.data)==null?void 0:d.message)||"Error rejecting the role";V.error(w,{position:"top-right",autoClose:3e3})}},H=async()=>{E.value=x.value,j.value=C.value,J.value=k.value,Y.value=D.value,await y()},Ve=()=>{x.value="",C.value="",k.value="",D.value="",m.value=1,H()};return y(),(s,e)=>{const d=De,r=Ce,w=xe,K=Se("IconBtn"),Q=_e,W=be;return S(),Pe($e,null,[o(Ne,null,{default:a(()=>[o(oe,{cols:"12"},{default:a(()=>[Be]),_:1}),o(oe,{cols:"12"},{default:a(()=>[o(F,null,{default:a(()=>[o(R,{class:"d-flex align-center justify-space-between flex-wrap gap-4"},{default:a(()=>[u("div",Ie,[u("div",null,[o(d,{modelValue:l(x),"onUpdate:modelValue":e[0]||(e[0]=t=>n(x)?x.value=t:null),density:"compact",placeholder:"Search","clear-icon":"tabler-circle-x",clearable:"",style:{"inline-size":"12.5rem"}},null,8,["modelValue"])]),u("div",ze,[o(r,{modelValue:l(C),"onUpdate:modelValue":e[1]||(e[1]=t=>n(C)?C.value=t:null),items:l(T),"clear-icon":"tabler-circle-x",clearable:"",placeholder:"Select Role Type",style:{"inline-size":"12.5rem"}},null,8,["modelValue","items"])]),u("div",Fe,[o(w,{modelValue:l(D),"onUpdate:modelValue":e[2]||(e[2]=t=>n(D)?D.value=t:null),class:"me-3","clear-icon":"tabler-circle-x",clearable:"",placeholder:"Select Date",style:{"inline-size":"200px"}},null,8,["modelValue"])]),u("div",Me,[o(r,{modelValue:l(k),"onUpdate:modelValue":e[3]||(e[3]=t=>n(k)?k.value=t:null),items:l(de),class:"me-3","clear-icon":"tabler-x",clearable:"",placeholder:"Status",style:{"inline-size":"200px"}},null,8,["modelValue","items"])]),o(b,{color:"primary","prepend-icon":"tabler-search",style:{"text-size-adjust":"auto","text-transform":"none"},onClick:H}),o(b,{color:"primary","prepend-icon":"tabler-refresh",style:{"text-size-adjust":"auto","text-transform":"none"},onClick:Ve})]),u("div",Oe,[o(r,{modelValue:l(p),"onUpdate:modelValue":e[4]||(e[4]=t=>n(p)?p.value=t:null),items:[5,10,20,25,50,100]},null,8,["modelValue"]),o(b,{density:"default",onClick:e[5]||(e[5]=t=>s.$router.push("/users/permission"))},{default:a(()=>[c(" Add Role ")]),_:1})])]),_:1}),o(ae),o(l(Te),{"items-per-page":l(p),"onUpdate:itemsPerPage":e[7]||(e[7]=t=>n(p)?p.value=t:null),page:l(m),"onUpdate:page":e[8]||(e[8]=t=>n(m)?m.value=t:null),headers:ie,items:l(fe),"items-length":l(A),"items-per-page-options":[{value:5,title:"5"},{value:10,title:"10"},{value:-1,title:"$vuetify.dataFooter.itemsPerPageAll"}],class:"text-no-wrap","onUpdate:options":ue},{"item.created_at":a(({item:t})=>[u("span",null,h(new Date(t.created_at).toISOString().split("T")[0]),1)]),"item.status":a(({item:t})=>[o(Ue,Ae({density:"default",label:""},ve(t.status)),null,16)]),bottom:a(()=>[o(ae),u("div",qe,[u("p",Ee,h(l(ke)({page:l(m),itemsPerPage:l(p)},l(A))),1),o(je,{modelValue:l(m),"onUpdate:modelValue":e[6]||(e[6]=t=>n(m)?m.value=t:null),length:Math.ceil(l(A)/l(p)),"total-visible":s.$vuetify.display.xs?1:Math.min(Math.ceil(l(A)/l(p)),5),"active-color":"primary","next-icon":"tabler-caret-right","prev-icon":"tabler-caret-left"},null,8,["modelValue","length","total-visible"])])]),"item.createdDate":a(({item:t})=>[u("span",null,h(t.createdDate.toLocaleString()),1)]),"item.actions":a(({item:t})=>[t.status==="approved"?(S(),M(b,{key:0,color:"warning",icon:"",size:"small",variant:"text",onClick:X=>s.$router.push(`/users/edit-role/${t.id}`)},{default:a(()=>[o(O,{icon:"tabler-edit",size:"22"})]),_:2},1032,["onClick"])):q("",!0),t.checker_status===!0&&t.status==="pending"?(S(),M(K,{key:1},{default:a(()=>[o(O,{icon:"tabler-square-check",color:"success",onClick:X=>pe(t)},null,8,["onClick"])]),_:2},1024)):q("",!0),t.checker_status===!0&&t.status==="pending"?(S(),M(K,{key:2},{default:a(()=>[o(O,{icon:"tabler-square-x",color:"error",onClick:X=>me(t)},null,8,["onClick"])]),_:2},1024)):q("",!0)]),_:1},8,["items-per-page","page","items","items-length"])]),_:1}),o(Q,{isDialogVisible:l(N),"onUpdate:isDialogVisible":e[9]||(e[9]=t=>n(N)?N.value=t:null),permissionName:l(I),"onUpdate:permissionName":e[10]||(e[10]=t=>n(I)?I.value=t:null),permissionID:l(z),"onUpdate:permissionID":e[11]||(e[11]=t=>n(z)?z.value=t:null),fetchData:l(y),"onUpdate:fetchData":e[12]||(e[12]=t=>n(y)?y.value=t:null)},null,8,["isDialogVisible","permissionName","permissionID","fetchData"]),o(Q,{isDialogVisible:l(B),"onUpdate:isDialogVisible":e[13]||(e[13]=t=>n(B)?B.value=t:null)},null,8,["isDialogVisible"])]),_:1})]),_:1}),o(se,{modelValue:l(v),"onUpdate:modelValue":e[17]||(e[17]=t=>n(v)?v.value=t:null),persistent:"",class:"v-dialog-sm"},{default:a(()=>[o(W,{onClick:e[14]||(e[14]=t=>v.value=!l(v))}),o(F,null,{default:a(()=>[o(R,null,{default:a(()=>[c(" Are you sure you want to Approve this Role: "+h(l(_).name)+"? ",1),Je,c(" This action cannot be undone. ")]),_:1}),o(R,{class:"d-flex justify-end gap-3 flex-wrap"},{default:a(()=>[o(b,{color:"secondary",variant:"tonal",onClick:e[15]||(e[15]=t=>v.value=!1)},{default:a(()=>[c(" Cancel ")]),_:1}),o(b,{color:"success",onClick:e[16]||(e[16]=t=>ge(l(_).id))},{default:a(()=>[c(" Approve ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(se,{modelValue:l(g),"onUpdate:modelValue":e[21]||(e[21]=t=>n(g)?g.value=t:null),persistent:"",class:"v-dialog-sm"},{default:a(()=>[o(W,{onClick:e[18]||(e[18]=t=>g.value=!l(g))}),o(F,null,{default:a(()=>[o(R,null,{default:a(()=>[c(" Are you sure you want to Reject this Role: "+h(l(_).name)+"? ",1),Le,c(" This action cannot be undone. ")]),_:1}),o(R,{class:"d-flex justify-end gap-3 flex-wrap"},{default:a(()=>[o(b,{color:"secondary",variant:"tonal",onClick:e[19]||(e[19]=t=>g.value=!1)},{default:a(()=>[c(" Cancel ")]),_:1}),o(b,{color:"error",onClick:e[20]||(e[20]=t=>ye(l(_).id))},{default:a(()=>[c(" Reject ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}});export{Jt as default};
