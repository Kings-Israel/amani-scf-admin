import{_ as ge}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-9e7a34d5.js";import{_ as ke}from"./AppTextField.vue_vue_type_script_setup_true_lang-298ad98d.js";import{_ as _e}from"./AppSelect.vue_vue_type_script_setup_true_lang-67ce80f3.js";import{p as Ve}from"./paginationMeta-4ad053a4.js";import{F as be}from"./FileSaver.min-162ac943.js";import{X as S}from"./xlsx-d63df831.js";import{u as N}from"./useApi-c9327355.js";import{c as j}from"./createUrl-3e678c2b.js";import{$ as Ce}from"./api-44dd0fa9.js";import{V as xe}from"./VSpacer-a56288e5.js";import{d as he,r as s,b6 as F,R as J,w as we,o as c,c as $e,b as l,f as n,e as p,p as a,aI as m,h as v,A as x,a4 as k,x as _,y as h,t as R,a9 as q,F as Be,a as Ae,aR as Ie,aS as Se}from"./index-5caaa453.js";import{V as Ue}from"./VAvatar-3ee4c690.js";import{V as U}from"./VCardText-3b4da816.js";import{V as K}from"./VDivider-d40713ce.js";import{V as De}from"./VDataTableServer-64dc84b4.js";import{V as Pe}from"./VChip-49676f7d.js";import{V as Me}from"./VPagination-4169e3c5.js";import{V as W}from"./VCard-1a5b2c5e.js";import{V as Te}from"./VDialog-808ce03e.js";import{_ as ze}from"./_plugin-vue_export-helper-c27b6911.js";import"./form-c9c578a3.js";import"./VTextField-604d91ff.js";/* empty css                   */import"./VCounter-728f7f8c.js";import"./transition-1886cce0.js";import"./VField-6b3808ed.js";import"./easing-9f15041e.js";import"./VInput-e87890b4.js";import"./forwardRefs-8348545e.js";import"./index-7dd1f5f0.js";import"./VSelect-f0a443ce.js";import"./VList-4b1bf96e.js";import"./ssrBoot-2696bccc.js";import"./createSimpleFunctional-9624028d.js";import"./dialog-transition-1ae6ec72.js";import"./VMenu-97c48b4e.js";import"./VOverlay-da001e16.js";import"./lazy-9cd674a5.js";import"./scopeId-484eb469.js";import"./VCheckboxBtn-1d552264.js";import"./VSelectionControl-e0df1dbd.js";import"./index-2898f57d.js";import"./VImg-6009f8f0.js";import"./VDataTable-1493872b.js";import"./VTable-f9bab7db.js";import"./filter-aecd5fc1.js";const Y=w=>(Ie("data-v-fd165a02"),w=w(),Se(),w),Ne={class:"d-flex flex-wrap gap-4 mx-5 my-5 row"},je={class:"d-flex align-center"},Fe={class:"d-flex gap-4 flex-wrap align-center"},Re=["onClick"],qe={class:"d-flex align-center justify-space-between flex-wrap gap-3 pa-5 pt-3"},Ee={class:"text-sm text-medium-emphasis mb-0"},Oe=Y(()=>p("br",null,null,-1)),Xe=Y(()=>p("br",null,null,-1)),He=he({__name:"company",async setup(w){let i,g;const Z=[{title:"Name",key:"name"},{title:"Bank",key:"bank"},{title:"Business ID Number",key:"business_identification_number"},{title:"Customer Type",key:"customer_type"},{title:"Bank Manager",key:"relationship_manager_name"},{title:"Business Segment",key:"business_segment"},{title:"Organization Type",key:"organization_type"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],D=s(!0),ee=s(0),V=s(""),$=s(),b=s(),C=s([]),r=s(10),u=s(1),E=s(),O=s(),f=s(!1),y=s(null),te=o=>{y.value=o,f.value=!0},ae=()=>{D.value=!D.value},oe=()=>{V.value=""},le=()=>{ee.value=0},ne=()=>{le(),oe()},se=s([{title:"Active",value:"active"},{title:"In active",value:"inactive"}]),ie=s([{title:"Approve",value:"active"},{title:"Reject",value:"inactive"}]),re=o=>{var t,d;u.value=o.page,E.value=(t=o.sortBy[0])==null?void 0:t.key,O.value=(d=o.sortBy[0])==null?void 0:d.order,console.log(o+0)},ce=o=>o==="active"?{text:"Active",color:"success"}:{text:"Inactive",color:"error"},P=o=>o&&o==="active"?{color:"success",icon:"tabler-thumb-up",title:"Deactivate"}:{color:"error",icon:"tabler-thumb-down",title:"Activate"},B=s(),{data:me,execute:Le}=([i,g]=F(()=>N(j("UI/get/banks/list"))),i=await i,g(),i),pe=me.value.data.map(o=>({title:o.name,value:o.id})),{data:X,execute:H}=([i,g]=F(()=>N(j("/all/UI/companies",{query:{q:V,status:$,bank:B,page:u,itemsPerPage:r,sortBy:E,orderBy:O}}))),i=await i,g(),i),L=J(()=>X.value.data),A=J(()=>X.value.total),{data:ue,execute:de}=([i,g]=F(()=>N(j("/UI/companies/changes"))),i=await i,g(),i);H(),de();const Q=ue.value.companychange;s([]);const M=async o=>{await Ce("/UI/companies/activate",{method:"POST",body:{ids:o,status:b.value}}),await H(),f.value=!1};we(b,o=>{o&&C.value.length&&M(C.value)});const ve=()=>{const o=S.utils.json_to_sheet(L.value),t=S.utils.book_new();S.utils.book_append_sheet(t,o,"Companies");const d=S.write(t,{bookType:"xlsx",type:"array"});be.saveAs(new Blob([d],{type:"application/octet-stream"}),"Companies.xlsx")};return(o,t)=>{const d=_e,fe=ke,T=Ae("IconBtn"),ye=ge;return c(),$e(Be,null,[l(W,{class:"mb-6"},{default:n(()=>[p("div",Ne,[p("div",je,[l(d,{modelValue:a(B),"onUpdate:modelValue":t[0]||(t[0]=e=>m(B)?B.value=e:null),items:a(pe),class:"me-1","clear-icon":"tabler-x",clearable:"",placeholder:"Bank",style:{"inline-size":"200px"}},null,8,["modelValue","items"]),l(fe,{modelValue:a(V),"onUpdate:modelValue":t[1]||(t[1]=e=>m(V)?V.value=e:null),"append-inner-icon":a(D)?"tabler-search":"tabler-map-pin-off",class:"me-1","clear-icon":"tabler-circle-x",clearable:"",color:"primary",placeholder:"Company Name",style:{"inline-size":"200px"},type:"text","onClick:appendInner":ae,"onClick:append":ne},null,8,["modelValue","append-inner-icon"]),l(d,{modelValue:a($),"onUpdate:modelValue":t[2]||(t[2]=e=>m($)?$.value=e:null),items:a(se),class:"me-1","clear-icon":"tabler-x",clearable:"",placeholder:"Status",style:{"inline-size":"100px"}},null,8,["modelValue","items"]),o.$can("manage","Company Changes Checker")&&o.$can("manage","Company Bulk Approve")?(c(),v(d,{key:0,modelValue:a(b),"onUpdate:modelValue":t[3]||(t[3]=e=>m(b)?b.value=e:null),items:a(ie),"item-title":"title","item-value":"value",class:"me-1","clear-icon":"tabler-x",clearable:"",chips:"",placeholder:"Bulk Actions",style:{"inline-size":"200px"}},null,8,["modelValue","items"])):x("",!0),l(xe)]),p("div",Fe,[l(d,{modelValue:a(r),"onUpdate:modelValue":t[4]||(t[4]=e=>m(r)?r.value=e:null),items:[5,10,20,25,50]},null,8,["modelValue"]),l(k,{color:"primary","prepend-icon":"tabler-download",style:{"text-size-adjust":"auto","text-transform":"none"},onClick:ve})])]),a(Q)>0?(c(),v(U,{key:0},{default:n(()=>[_(" Current pending changes "),l(Ue,{color:"error",size:"x-small"},{default:n(()=>[p("small",null,h(a(Q)),1)]),_:1})]),_:1})):x("",!0),l(K,{class:"mt-4"}),l(a(De),{"items-per-page":a(r),"onUpdate:itemsPerPage":t[6]||(t[6]=e=>m(r)?r.value=e:null),page:a(u),"onUpdate:page":t[7]||(t[7]=e=>m(u)?u.value=e:null),modelValue:a(C),"onUpdate:modelValue":t[8]||(t[8]=e=>m(C)?C.value=e:null),headers:Z,items:a(L),"items-length":a(A),"item-key":"id",class:"text-wrap","show-select":"","onUpdate:options":re},{"item.name":n(({item:e})=>[p("h6",null,[p("a",{href:"javascript:void(0)",class:"text-primary",onClick:z=>o.$router.push(`/companies/view/${e.id}`)},h(e.name),9,Re)])]),"item.status":n(({item:e})=>[l(Pe,R({density:"default",label:""},ce(e.status)),null,16)]),"item.actions":n(({item:e})=>{var z;return[o.$can("manage","Company Changes Checker")?(c(),v(T,{key:0,onClick:I=>o.$router.push(`/companies/view/${e.id}`)},{default:n(()=>[l(q,{icon:"tabler-eye",color:"info"})]),_:2},1032,["onClick"])):x("",!0),o.$can("manage","Company Changes Checker")?(c(),v(T,{key:1,onClick:I=>o.$router.push(`/companies/edit/${e.id}`)},{default:n(()=>[l(q,{icon:"tabler-pencil",color:"warning"})]),_:2},1032,["onClick"])):x("",!0),o.$can("manage","Company Changes Checker")?(c(),v(T,{key:2,title:(z=P(e.status))==null?void 0:z.title},{default:n(()=>{var I,G;return[l(q,{icon:(I=P(e.status))==null?void 0:I.icon,color:(G=P(e.status))==null?void 0:G.color,onClick:Qe=>te(e)},null,8,["icon","color","onClick"])]}),_:2},1032,["title"])):x("",!0)]}),bottom:n(()=>[l(K),p("div",qe,[p("p",Ee,h(a(Ve)({page:a(u),itemsPerPage:a(r)},a(A))),1),l(Me,{modelValue:a(u),"onUpdate:modelValue":t[5]||(t[5]=e=>m(u)?u.value=e:null),length:Math.min(Math.ceil(a(A)/a(r)),5),"total-visible":o.$vuetify.display.xs?1:Math.min(Math.ceil(a(A)/a(r)),5)},{prev:n(e=>[l(k,R({color:"default"},e,{variant:"tonal"}),null,16)]),next:n(e=>[l(k,R({color:"default"},e,{variant:"tonal"}),null,16)]),_:1},8,["modelValue","length","total-visible"])])]),_:1},8,["items-per-page","page","modelValue","items","items-length"])]),_:1}),l(Te,{modelValue:a(f),"onUpdate:modelValue":t[13]||(t[13]=e=>m(f)?f.value=e:null),persistent:"",class:"v-dialog-sm"},{default:n(()=>[l(ye,{onClick:t[9]||(t[9]=e=>f.value=!a(f))}),l(W,null,{default:n(()=>[a(y).status!=="active"?(c(),v(U,{key:0},{default:n(()=>[_(" Are you sure you want to activate company: "+h(a(y).name)+"? ",1),Oe]),_:1})):(c(),v(U,{key:1},{default:n(()=>[_(" Are you sure you want to deactivate company: "+h(a(y).name)+"? ",1),Xe]),_:1})),l(U,{class:"d-flex justify-end gap-3 flex-wrap"},{default:n(()=>[l(k,{color:"secondary",variant:"tonal",onClick:t[10]||(t[10]=e=>f.value=!1)},{default:n(()=>[_(" Cancel ")]),_:1}),a(y).status!=="active"?(c(),v(k,{key:0,color:"success",onClick:t[11]||(t[11]=e=>M([a(y).id]))},{default:n(()=>[_(" Activate ")]),_:1})):(c(),v(k,{key:1,color:"error",onClick:t[12]||(t[12]=e=>M([a(y).id]))},{default:n(()=>[_(" Deactivate ")]),_:1}))]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}});const Rt=ze(He,[["__scopeId","data-v-fd165a02"]]);export{Rt as default};
