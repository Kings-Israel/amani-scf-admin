import{r as n,e as le}from"./validators-db74a876.js";import{_ as oe}from"./AppTextField.vue_vue_type_script_setup_true_lang-93dc1e26.js";import{_ as te}from"./AppSelect.vue_vue_type_script_setup_true_lang-32a0f469.js";import{_ as ae}from"./AppStepper.vue_vue_type_style_index_0_lang-c08c6f80.js";import{i as D}from"./index-4532b75c.js";import{d as re,k as se,l as me,r as p,b6 as U,R as k,w as ue,ck as ne,p as a,o as c,c as v,b as o,f as t,x as M,aI as w,z as ce,F as E,j as pe,e as B,a4 as de,A as x,aM as ie,h as X}from"./index-75b434bc.js";import{u as F}from"./useApi-776c55ea.js";import{c as ye}from"./createUrl-149317bf.js";import{$ as N}from"./api-0c1dfdf3.js";import{V as be}from"./VSnackbar-f21966b4.js";import{V as I}from"./VRow-d6f20668.js";import{V as d}from"./VCol-35b3d337.js";import{V as q}from"./VCardText-76f31582.js";import{V as Ve}from"./VForm-e46f5921.js";import{V as he,a as fe}from"./VWindowItem-04415d19.js";import{V as _e}from"./VCard-95c0d706.js";import"./helpers-681711bc.js";import"./form-2b416184.js";import"./VTextField-05e93cc8.js";/* empty css                   */import"./VCounter-3e4b236e.js";import"./transition-6afda34e.js";import"./VField-82993695.js";import"./easing-9f15041e.js";import"./VInput-b46333d7.js";import"./forwardRefs-8348545e.js";import"./index-97808f23.js";import"./VSelect-54e8b29a.js";import"./VList-c7d4c8b4.js";import"./ssrBoot-7f224ca6.js";import"./createSimpleFunctional-4b3a0a39.js";import"./VAvatar-071125b9.js";import"./VImg-ba4b392a.js";import"./VDivider-fc890531.js";import"./dialog-transition-14fdab67.js";import"./VMenu-3f143933.js";import"./VOverlay-0b79a00d.js";import"./lazy-0bb5e457.js";import"./scopeId-ee2feb8e.js";import"./VCheckboxBtn-0f22f589.js";import"./VSelectionControl-e1264669.js";import"./VChip-e2ddd660.js";import"./VSlideGroup-3e745b05.js";import"./VSlideGroupItem-95742265.js";import"./index-2898f57d.js";/* empty css              */const ke={key:0},ve={key:0},we={class:"d-flex flex-wrap gap-4 justify-sm-space-between justify-center mt-8"},hl=re({__name:"[id]",async setup(Xe){var S,T,$,A;let s,i;const j=l=>/^\+(\d{1,3})(\d{9,15})$/.test(l)?!0:"Please enter a valid phone number with the country code (e.g., +2547XXXXXXXX)",g=se(),z=[{title:"User Details",icon:"tabler-building",subtitle:"Setup account details"}],P=me(),O=p([]),R=p([]),y=p(0),W=p("CRM"),b=p("Dealer"),{data:L,execute:ge}=([s,i]=U(()=>F(ye("/get/UI/user/roles",{query:{roleType:b}}))),s=await s,i(),s),{data:V}=([s,i]=U(()=>F(`/get/UI/user/roles/${g.params.id}`)),s=await s,i(),s);[s,i]=U(()=>F(`/UI/roles/permissions/${g.params.id}`)),s=await s,i();const G={module:"",category:"",role:(S=V.value)==null?void 0:S.role,user_id:g.params.id,name:(T=V.value)==null?void 0:T.name,email:($=V.value)==null?void 0:$.email,contactNumber:(A=V.value)==null?void 0:A.phone_number},m=p(structuredClone(G)),H=k(()=>L.value),J=[{key:"name",show:!0,type:"text",model:"name",label:"Full Name",placeholder:"Enter Full Name",rules:[n]},{key:"email",show:!0,type:"email",model:"email",label:"Email",placeholder:"Enter Email",rules:[n,le]},{key:"contactNumber",type:"text",show:!0,model:"contactNumber",label:"Contact No.",placeholder:"+2547XXXXXXXX",rules:[n,j]}],K=[{key:"typeOfModule",type:"select",show:!1,model:"selectedModule",label:"Module",placeholder:"Module",items:["Bank","Company","CRM"],rules:[n]}],Q=k(()=>[{key:"roles",type:"select",show:!0,model:"role",label:"Roles",placeholder:"Roles",items:H.value,rules:[n]}]),Y=k(()=>[{key:"company",type:"select",model:"company",label:"Companies",placeholder:"Select Company",items:R.value,rules:[n]},{key:"roleTypes",type:"select",show:!1,value:b,model:b,label:"Different Role Types",placeholder:"Role Types",rules:[n],items:["Dealer","Vendor","Anchor"]}]);ue(W,l=>{m.value.module=l}),ne(async()=>{O.value=await N("/get/banks/names"),R.value=await N("/company/names")});const C=p(!1),Z=k(()=>{let l=[...K];return m.value.module==="Bank"?l=l.concat(bankFields.value):m.value.module==="Company"&&(l=l.concat(Y.value)),l=l.concat(Q.value),l.concat(J)}),ee=async()=>{try{const l=await N("/auth/UI/edit/user",{method:"POST",body:m.value,onResponseError({response:h}){var f;const _=((f=h==null?void 0:h.data)==null?void 0:f.message)||"An error occurred while updating the user";console.log("Error",h),D.error(_,{position:"top-right",autoClose:3e3})}}),{message:r}=l;r&&(D.success(r,{position:"top-right",autoClose:3e3}),await ie(()=>{P.push("/users/list")}))}catch{}};return(l,r)=>{const h=ae,_=te,f=oe;return a(V)?(c(),v("div",ke,[o(be,{modelValue:a(C),"onUpdate:modelValue":r[0]||(r[0]=e=>w(C)?C.value=e:null),color:"success",location:"top end",variant:"flat"},{default:t(()=>[M(" User updated Successfully ")]),_:1},8,["modelValue"]),o(_e,null,{default:t(()=>[o(I,null,{default:t(()=>[o(d,{class:ce(l.$vuetify.display.smAndDown?"border-b":"border-e"),cols:"12",md:"4"},{default:t(()=>[o(q,null,{default:t(()=>[o(h,{"current-step":a(y),"onUpdate:currentStep":r[1]||(r[1]=e=>w(y)?y.value=e:null),items:z,class:"stepper-icon-step-bg",direction:"vertical","icon-size":"24"},null,8,["current-step"])]),_:1})]),_:1},8,["class"]),o(d,{cols:"12",md:"8"},{default:t(()=>[o(q,null,{default:t(()=>[o(Ve,null,{default:t(()=>[o(he,{modelValue:a(y),"onUpdate:modelValue":r[4]||(r[4]=e=>w(y)?y.value=e:null),class:"disable-tab-transition"},{default:t(()=>[o(fe,null,{default:t(()=>[o(I,null,{default:t(()=>[(c(!0),v(E,null,pe(a(Z),e=>(c(),v(E,{key:e.key},[e.type==="select"&&e.key==="roleTypes"&&!e.show?(c(),X(d,{key:0,cols:"12",md:"12"},{default:t(()=>[o(_,{modelValue:a(b),"onUpdate:modelValue":r[2]||(r[2]=u=>w(b)?b.value=u:null),items:e.items,label:e.label,placeholder:e.placeholder,rules:e.rules},null,8,["modelValue","items","label","placeholder","rules"])]),_:2},1024)):e.type==="select"&&e.show?(c(),X(d,{key:1,cols:"12",md:"8"},{default:t(()=>[o(_,{modelValue:a(m)[e.model],"onUpdate:modelValue":u=>a(m)[e.model]=u,items:e.items,label:e.label,placeholder:e.placeholder,rules:e.rules,chips:"",multiple:"","closable-chips":""},null,8,["modelValue","onUpdate:modelValue","items","label","placeholder","rules"])]),_:2},1024)):e.type==="text"?(c(),X(d,{key:2,cols:"12",md:"8"},{default:t(()=>[o(f,{modelValue:a(m)[e.model],"onUpdate:modelValue":u=>a(m)[e.model]=u,label:e.label,placeholder:e.placeholder,readonly:e.readonly,rules:e.rules},null,8,["modelValue","onUpdate:modelValue","label","placeholder","readonly","rules"])]),_:2},1024)):e.type==="email"?(c(),X(d,{key:3,cols:"12",md:"8"},{default:t(()=>[o(f,{modelValue:a(m)[e.model],"onUpdate:modelValue":u=>a(m)[e.model]=u,label:e.label,placeholder:e.placeholder,readonly:e.readonly,rules:e.rules},null,8,["modelValue","onUpdate:modelValue","label","placeholder","readonly","rules"])]),_:2},1024)):x("",!0),B("template",null,[a(V)?(c(),v("div",ve,[o(d,{cols:"12",md:"8"},{default:t(()=>[o(f,{modelValue:a(m).contactNumber,"onUpdate:modelValue":r[3]||(r[3]=u=>a(m).contactNumber=u),label:"Phone Number",placeholder:"+254 XXX XXX XXX",rules:["requiredValidator"in l?l.requiredValidator:a(n),l.numericValidator],inputmode:"tel",pattern:"^\\+?\\d*$",maxlength:"15"},null,8,["modelValue","rules"])]),_:1})])):x("",!0)])],64))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"]),B("div",we,[o(de,{"append-icon":"tabler-check",color:"success",onClick:ee},{default:t(()=>[M(" submit ")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])):x("",!0)}}});export{hl as default};
