import{_ as ke}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-035125fd.js";import{_ as be}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-544577ba.js";import{_ as xe}from"./AppTextField.vue_vue_type_script_setup_true_lang-93dc1e26.js";import{_ as Ve}from"./AppSelect.vue_vue_type_script_setup_true_lang-32a0f469.js";import{F as he}from"./FileSaver.min-4f66c306.js";import{X as U}from"./xlsx-d63df831.js";import{p as Ce}from"./paginationMeta-4ad053a4.js";import{u as z}from"./useApi-776c55ea.js";import{c as I}from"./createUrl-149317bf.js";import{$ as we}from"./api-0c1dfdf3.js";import{d as Pe,b6 as C,r as n,R as Q,w as $e,o as c,c as Ae,b as l,f as r,e as s,p as t,aI as u,h as p,A as y,a4 as T,x as k,y as _,t as De,a9 as F,F as Se,a as Be,aR as Ue,aS as ze}from"./index-75b434bc.js";import{V as Ie}from"./VAvatar-071125b9.js";import{V as L}from"./VCardText-76f31582.js";import{V as Te}from"./VDataTable-c3cccdda.js";import{V as Fe}from"./VChip-e2ddd660.js";import{V as Le}from"./VDivider-fc890531.js";import{V as je}from"./VPagination-2b54b87a.js";import{V as G}from"./VCard-95c0d706.js";import{V as Ne}from"./VDialog-bc06d443.js";import{_ as Re}from"./_plugin-vue_export-helper-c27b6911.js";import"./VField-82993695.js";import"./form-2b416184.js";import"./easing-9f15041e.js";import"./VInput-b46333d7.js";import"./transition-6afda34e.js";import"./VTextField-05e93cc8.js";/* empty css                   */import"./VCounter-3e4b236e.js";import"./forwardRefs-8348545e.js";import"./index-97808f23.js";import"./VSelect-54e8b29a.js";import"./VList-c7d4c8b4.js";import"./ssrBoot-7f224ca6.js";import"./createSimpleFunctional-4b3a0a39.js";import"./dialog-transition-14fdab67.js";import"./VMenu-3f143933.js";import"./VOverlay-0b79a00d.js";import"./lazy-0bb5e457.js";import"./scopeId-ee2feb8e.js";import"./VCheckboxBtn-0f22f589.js";import"./VSelectionControl-e1264669.js";import"./index-2898f57d.js";import"./VImg-ba4b392a.js";import"./VTable-de2d1039.js";import"./filter-3bfef89c.js";const H=w=>(Ue("data-v-0d03b75b"),w=w(),ze(),w),Me={class:"d-flex flex-wrap gap-4 mx-5 my-5"},qe={class:"d-flex align-center"},Ee={class:"d-flex gap-4 flex-wrap align-center"},Xe={class:"text-h8"},Oe=["onClick"],Qe={class:"d-flex align-center"},Ge={class:"d-flex align-center justify-space-between flex-wrap gap-3 pa-5 pt-3"},He={class:"text-sm text-medium-emphasis mb-0"},Je=H(()=>s("br",null,null,-1)),Ke=H(()=>s("br",null,null,-1)),We=Pe({__name:"anchor",async setup(w){let i,m;const{data:J,execute:K}=([i,m]=C(()=>z(I("UI/get/banks/list"))),i=await i,m(),i);[i,m]=C(()=>K()),await i,m();const W=J.value.data.map(o=>({title:o.name,value:o.id})),P=n(null),{data:Y,execute:Z}=([i,m]=C(()=>z(I("get/UI/configurations/system-configurations",{query:{}}))),i=await i,m(),i);Z(),Y.value.admin_maker_checker;const ee=n(!1),te=o=>{if(o==="active")return{text:"Active",color:"success"};if(o==="pending")return{text:"Pending",color:"info"};if(o==="pending_checker_approval")return{text:"Pending Checker",color:"info"};if(o==="suspended")return{text:"Suspended",color:"error"}},$=n(""),ae=n(),oe=n(),A=n(),b=n([]),x=n(),d=n(50),V=n(1),le=n(),ne=n(),D=n(),re=n(),g=n(!1),v=n(null),ie=o=>{v.value=o,g.value=!0},se=n([{title:"Active",value:"active"},{title:"In active",value:"inactive"}]),ce=n([{title:"Approve",value:"active"},{title:"Reject",value:"inactive"}]),M=o=>o&&o==="active"?{color:"success",icon:"tabler-thumb-up"}:{color:"error",icon:"tabler-thumb-down"},me=(o,a)=>o/a*100,ue=[{title:"Anchor",key:"name"},{title:"Name",key:"code"},{title:"Bank",key:"bank"},{title:"Approval Date",key:"approved_date"},{title:"Program Limit",key:"program_limit"},{title:"Max Limit Per Account",key:"max_limit_per_account"},{title:"Min Financing Days",key:"min_financing_days"},{title:"Max Financing Days",key:"max_financing_days"},{title:"Program Type",key:"program_type"},{title:"Status",key:"account_status"},{title:"Actions",key:"actions",sortable:!1}],S=n(null),pe=n([{title:"Dealer Financing",value:"dealer financing"},{title:"Vendor Financing",value:"vendor financing"},{title:"Factoring",value:"factoring"}]),{data:q,execute:B}=([i,m]=C(()=>z(I("/get/UI/all/programs",{query:{q:$,status:A,plan:oe,role:ae,bank_id:P,program_type:S,itemsPerPage:d,page:V,sortBy:le,orderBy:ne,fromdate:D,todate:re}}))),i=await i,m(),i),{data:de,execute:ge}=([i,m]=C(()=>z(I("/programs/changes"))),i=await i,m(),i),E=Q(()=>q.value.data),j=Q(()=>q.value.total);B(),ge();const X=de.value.programchange,N=async o=>{await we("/programs/admin/activate",{method:"POST",body:{ids:o,status:x.value}}),await B(),g.value=!1};$e(x,o=>{o&&b.value.length&&N(b.value)});const ve=()=>{const o=U.utils.json_to_sheet(E.value),a=U.utils.book_new();U.utils.book_append_sheet(a,o,"Programs");const f=U.write(a,{bookType:"xlsx",type:"array"});he.saveAs(new Blob([f],{type:"application/octet-stream"}),"programs.xlsx")};return(o,a)=>{const f=Ve,fe=xe,_e=be,R=Be("IconBtn"),ye=ke;return c(),Ae(Se,null,[l(G,{class:"mb-6"},{default:r(()=>[s("div",Me,[s("div",qe,[l(f,{modelValue:t(P),"onUpdate:modelValue":a[0]||(a[0]=e=>u(P)?P.value=e:null),items:t(W),class:"me-3","clear-icon":"tabler-x",clearable:"",placeholder:"Select Bank",style:{"inline-size":"200px"},onChange:t(B)},null,8,["modelValue","items","onChange"]),l(f,{modelValue:t(S),"onUpdate:modelValue":a[1]||(a[1]=e=>u(S)?S.value=e:null),items:t(pe),class:"me-3","clear-icon":"tabler-x",clearable:"",placeholder:"Program Type",style:{"inline-size":"200px"},onChange:t(B)},null,8,["modelValue","items","onChange"]),l(fe,{modelValue:t($),"onUpdate:modelValue":a[2]||(a[2]=e=>u($)?$.value=e:null),class:"me-3","clear-icon":"tabler-circle-x",clearable:"",color:"primary",placeholder:"Program Name",style:{"inline-size":"200px"},type:"text"},null,8,["modelValue"]),l(_e,{modelValue:t(D),"onUpdate:modelValue":a[3]||(a[3]=e=>u(D)?D.value=e:null),class:"me-3","clear-icon":"tabler-x",clearable:"",placeholder:"Select Date",style:{"inline-size":"200px"}},null,8,["modelValue"]),l(f,{modelValue:t(A),"onUpdate:modelValue":a[4]||(a[4]=e=>u(A)?A.value=e:null),items:t(se),class:"me-3","clear-icon":"tabler-x",clearable:"",placeholder:"Status",style:{"inline-size":"200px"}},null,8,["modelValue","items"]),o.$can("manage","Program Changes Checker")&&o.$can("manage","Program Bulk Approve")?(c(),p(f,{key:0,modelValue:t(x),"onUpdate:modelValue":a[5]||(a[5]=e=>u(x)?x.value=e:null),items:t(ce),"item-title":"title","item-value":"value",class:"me-1","clear-icon":"tabler-x",clearable:"",chips:"",placeholder:"Bulk Actions",style:{"inline-size":"200px"}},null,8,["modelValue","items"])):y("",!0)]),s("div",Ee,[l(f,{modelValue:t(d),"onUpdate:modelValue":a[6]||(a[6]=e=>u(d)?d.value=e:null),items:[5,10,20,25,50]},null,8,["modelValue"]),l(T,{color:"primary","prepend-icon":"tabler-download",style:{"text-size-adjust":"auto","text-transform":"none"},onClick:ve})])]),t(X)>0?(c(),p(L,{key:0},{default:r(()=>[k(" Current pending changes "),l(Ie,{color:"error",size:"x-small"},{default:r(()=>[s("small",null,_(t(X)),1)]),_:1})]),_:1})):y("",!0),l(t(Te),{modelValue:t(b),"onUpdate:modelValue":a[8]||(a[8]=e=>u(b)?b.value=e:null),headers:ue,items:t(E),"items-per-page":t(d),class:"text-wrap",size:"x-small","show-select":""},{"item.name":r(({item:e})=>[s("h6",Xe,[s("a",{href:"javascript:void(0)",onClick:h=>o.$router.push(`/program/view/${e.id}`)},_(e.name),9,Oe)]),me(e.program_limit,e.max_limit_per_account)<10?(c(),p(F,{key:0,icon:"tabler-alert-circle",title:"Program Limit is almost depleted",color:"error"})):y("",!0)]),"item.program_limit":r(({item:e})=>[s("p",null,_(e.program_limit.toLocaleString()),1)]),"item.max_limit_per_account":r(({item:e})=>[s("p",null,_(e.max_limit_per_account.toLocaleString()),1)]),"item.account_status":r(({item:e})=>[l(Fe,De({density:"default",label:""},te(e.account_status)),null,16)]),"item.actions":r(({item:e})=>[s("div",Qe,[o.$can("manage","Program Changes Checker")?(c(),p(R,{key:0,class:"small-icon-btn",onClick:h=>o.$router.push(`/program/view/${e.id}`)},{default:r(()=>[l(F,{icon:"tabler-eye",color:"info",size:"small"})]),_:2},1032,["onClick"])):y("",!0),o.$can("manage","Program Changes Checker")?(c(),p(R,{key:1,class:"small-icon-btn",onClick:h=>o.$router.push(`/program/view/edit-program/${e.id}`)},{default:r(()=>[l(F,{icon:"tabler-pencil",color:"warning",size:"small"})]),_:2},1032,["onClick"])):y("",!0),o.$can("manage","Program Changes Checker")?(c(),p(R,{key:2,class:"small-icon-btn"},{default:r(()=>{var h,O;return[l(F,{icon:(h=M(e.account_status))==null?void 0:h.icon,color:(O=M(e.account_status))==null?void 0:O.color,title:e.account_status,size:"small",onClick:Ze=>ie(e)},null,8,["icon","color","title","onClick"])]}),_:2},1024)):y("",!0)])]),bottom:r(()=>[l(Le),s("div",Ge,[s("p",He,_(t(Ce)({page:t(V),itemsPerPage:t(d)},t(j))),1),l(je,{modelValue:t(V),"onUpdate:modelValue":a[7]||(a[7]=e=>u(V)?V.value=e:null),length:Math.ceil(t(j)/t(d)),"total-visible":o.$vuetify.display.xs?1:Math.min(Math.ceil(t(j)/t(d)),5),"active-color":"primary","next-icon":"tabler-caret-right","prev-icon":"tabler-caret-left"},null,8,["modelValue","length","total-visible"])])]),_:1},8,["modelValue","items","items-per-page"])]),_:1}),l(Ne,{modelValue:t(g),"onUpdate:modelValue":a[13]||(a[13]=e=>u(g)?g.value=e:null),persistent:"",class:"v-dialog-sm"},{default:r(()=>[l(ye,{onClick:a[9]||(a[9]=e=>g.value=!t(g))}),l(G,null,{default:r(()=>[t(v).account_status!=="active"?(c(),p(L,{key:0},{default:r(()=>[k(" Are you sure you want to activate program: "+_(t(v).name)+"? ",1),Je]),_:1})):(c(),p(L,{key:1},{default:r(()=>[k(" Are you sure you want to deactivate program: "+_(t(v).name)+"? ",1),Ke]),_:1})),l(L,{class:"d-flex justify-end gap-3 flex-wrap"},{default:r(()=>[l(T,{color:"secondary",variant:"tonal",onClick:a[10]||(a[10]=e=>ee.value=!1)},{default:r(()=>[k(" Cancel ")]),_:1}),t(v).account_status!=="active"?(c(),p(T,{key:0,color:"success",onClick:a[11]||(a[11]=e=>N([t(v).id]))},{default:r(()=>[k(" Activate ")]),_:1})):(c(),p(T,{key:1,color:"error",onClick:a[12]||(a[12]=e=>N([t(v).id]))},{default:r(()=>[k(" Deactivate ")]),_:1}))]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}});const Ot=Re(We,[["__scopeId","data-v-0d03b75b"]]);export{Ot as default};
