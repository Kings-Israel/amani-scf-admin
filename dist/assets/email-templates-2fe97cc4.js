import{_ as _e}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-035125fd.js";import{_ as Ve}from"./AppSelect.vue_vue_type_script_setup_true_lang-32a0f469.js";import{_ as ke}from"./AppTextField.vue_vue_type_script_setup_true_lang-93dc1e26.js";import{i as c}from"./index-4532b75c.js";import{_ as xe}from"./edit-email-template.vue_vue_type_script_setup_true_lang-484c7150.js";import{p as we}from"./paginationMeta-4ad053a4.js";import{u as he}from"./useApi-776c55ea.js";import{c as De}from"./createUrl-149317bf.js";import{$ as U}from"./api-0c1dfdf3.js";import{d as $e,r as i,R as N,b6 as Te,o as b,c as Ae,b as a,f as l,e as f,p as o,aI as v,a4 as m,x as r,y as T,t as K,h as V,a9 as A,A as k,F as je,a as Pe}from"./index-75b434bc.js";import{V as Ue}from"./VDataTable-c3cccdda.js";import{V as L}from"./VChip-e2ddd660.js";import{V as Ee}from"./VDivider-fc890531.js";import{V as Se}from"./VPagination-2b54b87a.js";import{V as E}from"./VCard-95c0d706.js";import{V as g}from"./VCardText-76f31582.js";import{V as z}from"./VDialog-bc06d443.js";import"./form-2b416184.js";import"./VSelect-54e8b29a.js";import"./VTextField-05e93cc8.js";/* empty css                   */import"./VCounter-3e4b236e.js";import"./transition-6afda34e.js";import"./VField-82993695.js";import"./easing-9f15041e.js";import"./VInput-b46333d7.js";import"./forwardRefs-8348545e.js";import"./index-97808f23.js";import"./VList-c7d4c8b4.js";import"./ssrBoot-7f224ca6.js";import"./createSimpleFunctional-4b3a0a39.js";import"./VAvatar-071125b9.js";import"./VImg-ba4b392a.js";import"./dialog-transition-14fdab67.js";import"./VMenu-3f143933.js";import"./VOverlay-0b79a00d.js";import"./lazy-0bb5e457.js";import"./scopeId-ee2feb8e.js";import"./VCheckboxBtn-0f22f589.js";import"./VSelectionControl-e1264669.js";import"./AppStepper.vue_vue_type_style_index_0_lang-c08c6f80.js";import"./VSlideGroup-3e745b05.js";import"./VSlideGroupItem-95742265.js";import"./email-details.vue_vue_type_script_setup_true_lang-aefef72e.js";import"./TiptapEditor.vue_vue_type_style_index_0_lang-e76d5625.js";import"./index-78b172a6.js";import"./VCol-35b3d337.js";/* empty css              */import"./VRow-d6f20668.js";import"./header-footer.vue_vue_type_script_setup_true_lang-d4488e83.js";import"./VForm-e46f5921.js";import"./VWindowItem-04415d19.js";import"./index-2898f57d.js";import"./VTable-de2d1039.js";import"./filter-3bfef89c.js";const Ie={class:"d-flex flex-wrap gap-4 mx-5 my-5"},Be={class:"d-flex align-center flex-wrap gap-4"},Fe={class:"d-flex gap-4 flex-wrap align-center"},ze={class:"text-h6"},Re={href:"javascript:void(0)"},Me={class:"d-flex align-center justify-space-between flex-wrap gap-3 pa-5 pt-3"},Ne={class:"text-sm text-medium-emphasis mb-0"},Oe=f("br",null,null,-1),qe=f("br",null,null,-1),Ye=f("br",null,null,-1),Qe=f("br",null,null,-1),We=f("br",null,null,-1),Kt=$e({__name:"email-templates",async setup(Ge){let R,O;const q=i("");i();const u=i(null),Y=i(),Q=i(),X=i(),x=i(!1),j=i(!1),w=i(!1),h=i(!1),D=i(!1),$=i(!1),S=i(null),I=i(null),B=i(""),C=i(50),P=i(1);i();const Z=i();i(),i();const ee=i([{title:"Active",value:"active"},{title:"In active",value:"inactive"}]),te=i([{title:"Dealer Financing",value:"dealer_financing"},{title:"Vendor Financing",value:"vendor_financing"},{title:"Factoring",value:"factoring"}]),ae=s=>{u.value=s,j.value=!0},le=s=>{u.value=s,w.value=!0},oe=s=>{u.value=s,h.value=!0},se=s=>{u.value=s,D.value=!0},ne=s=>{u.value=s,$.value=!0},ie=s=>{u.value=s,x.value=!0},W=s=>s&&s==="active"?{color:"error",icon:"tabler-circle-dot"}:{color:"primary",icon:"tabler-circle-check"},re=s=>s==="active"?{text:"Active",color:"success"}:s==="waiting_checker_approval"?{text:"Pending Checker",color:"info"}:{text:"Inactive",color:"error"},ue=s=>s==="vendor_financing"?{text:"Vendor Financing"}:s==="dealer_financing"?{text:"Dealer Financing"}:{text:"Factoring"},ce=[{title:"Template Name",key:"name"},{title:"Subject",key:"subject"},{title:"Product Type",key:"product_type"},{title:"Status",key:"status"},{title:"Actions",key:"actions",sortable:!1}],pe=N(()=>({q:q.value,status:Y.value,product:Q.value,page:P.value,itemsPerPage:C.value,orderBy:Z.value})),{data:G,execute:y}=([R,O]=Te(()=>he(De("/UI/configurations/email-templates",{query:pe}))),R=await R,O(),R),me=N(()=>G.value.data),M=N(()=>G.value.total);y();const de=async s=>{var e,d;try{const n=await U("/UI/configurations/email-templates/approve",{method:"POST",body:{template_id:s}});n.message==="Email template approved successfully"?(c.success(n.message||"Email template approved successfully",{position:"top-right",autoClose:3e3}),await y(),w.value=!1):n.status===403?c.warn(n.message||"You cannot approve this template",{position:"top-right",autoClose:3e3}):c.error(n.message||"Something went wrong",{position:"top-right",autoClose:3e3})}catch(n){const p=((d=(e=n.response)==null?void 0:e.data)==null?void 0:d.message)||"Error approving the template";c.error(p,{position:"top-right",autoClose:3e3})}},fe=async s=>{var e,d;try{const n=await U("/UI/configurations/email-templates/reject",{method:"POST",body:{template_id:s}});n.message==="Email template deactivated successfully"?(c.success(n.message||"Email template deactivated successfully",{position:"top-right",autoClose:3e3}),await y(),h.value=!1):n.status===403?c.warn(n.message||"You cannot reject this template",{position:"top-right",autoClose:3e3}):c.error(n.message||"Something went wrong",{position:"top-right",autoClose:3e3})}catch(n){const p=((d=(e=n.response)==null?void 0:e.data)==null?void 0:d.message)||"Error rejecting the template";c.error(p,{position:"top-right",autoClose:3e3})}},ve=async s=>{var e,d;try{const n=await U("/UI/configurations/email-templates/enable",{method:"POST",body:{template_id:s}});n.message==="Activation initiated successfully"?(c.success(n.message||"Activation initiated successfully",{position:"top-right",autoClose:3e3}),await y(),D.value=!1):n.status===403?c.warn(n.message||"You cannot enable this template",{position:"top-right",autoClose:3e3}):c.error(n.message||"Something went wrong",{position:"top-right",autoClose:3e3})}catch(n){const p=((d=(e=n.response)==null?void 0:e.data)==null?void 0:d.message)||"Error enabling the template";c.error(p,{position:"top-right",autoClose:3e3})}},ge=async s=>{var e,d;try{const n=await U("/UI/configurations/email-templates/disable",{method:"POST",body:{template_id:s}});n.message==="Deactivation initiated successfully"?(c.success(n.message||"Deactivation initiated successfully",{position:"top-right",autoClose:3e3}),await y(),$.value=!1):n.status===403?c.warn(n.message||"You cannot disable this template",{position:"top-right",autoClose:3e3}):c.error(n.message||"Something went wrong",{position:"top-right",autoClose:3e3})}catch(n){const p=((d=(e=n.response)==null?void 0:e.data)==null?void 0:d.message)||"Error disabling the template";c.error(p,{position:"top-right",autoClose:3e3})}},ye=async s=>{try{await U(`/UI/configurations/delete/email-template/${s}`,{method:"POST",onResponseError({response:e}){errors.value=e._data.errors}}),await y(),j.value=!1}catch(e){console.error(e)}},be=async s=>{await U("/UI/configurations/activate/email-template",{method:"POST",body:{ids:s,status:X.value}}),await y()},H=async()=>{q.value=B.value,Y.value=S.value,Q.value=I.value,await y()},Ce=()=>{B.value="",S.value="",I.value="",P.value=1,H()};return y(),(s,e)=>{const d=ke,n=Ve,p=Pe("IconBtn"),F=_e;return b(),Ae(je,null,[a(E,{class:"mb-6"},{default:l(()=>[f("div",Ie,[f("div",Be,[a(d,{modelValue:o(B),"onUpdate:modelValue":e[0]||(e[0]=t=>v(B)?B.value=t:null),class:"me-3","clear-icon":"tabler-circle-x",clearable:"",color:"primary",placeholder:"Template Name",style:{"inline-size":"200px"},type:"text"},null,8,["modelValue"]),a(n,{modelValue:o(S),"onUpdate:modelValue":e[1]||(e[1]=t=>v(S)?S.value=t:null),items:o(ee),class:"me-3","clear-icon":"tabler-x",clearable:"",placeholder:"Status",style:{"inline-size":"200px"}},null,8,["modelValue","items"]),a(n,{modelValue:o(I),"onUpdate:modelValue":e[2]||(e[2]=t=>v(I)?I.value=t:null),items:o(te),class:"me-3","clear-icon":"tabler-x",clearable:"",placeholder:"Product Type",style:{"inline-size":"200px"}},null,8,["modelValue","items"]),a(m,{color:"primary","prepend-icon":"tabler-search",style:{"text-size-adjust":"auto","text-transform":"none"},onClick:H}),a(m,{color:"primary","prepend-icon":"tabler-refresh",style:{"text-size-adjust":"auto","text-transform":"none"},onClick:Ce})]),f("div",Fe,[a(n,{modelValue:o(C),"onUpdate:modelValue":e[3]||(e[3]=t=>v(C)?C.value=t:null),items:[5,10,20,25,50]},null,8,["modelValue"]),a(m,{color:"primary","prepend-icon":"tabler-download",style:{"text-size-adjust":"auto","text-transform":"none"}}),a(m,{color:"primary","prepend-icon":"tabler-plus",style:{"text-size-adjust":"auto","text-transform":"none"},onClick:e[4]||(e[4]=t=>s.$router.push("/configurations/view/add-email-template"))},{default:l(()=>[r(" Add Template ")]),_:1})])]),a(o(Ue),{headers:ce,items:o(me),"items-per-page":o(C),class:"text-no-wrap"},{"item.name":l(({item:t})=>[f("h6",ze,[f("a",Re,T(t.name),1)])]),"item.status":l(({item:t})=>[a(L,K({density:"default",label:""},re(t.status)),null,16)]),"item.product_type":l(({item:t})=>[a(L,K({density:"default",label:""},ue(t.product_type)),null,16)]),"item.actions":l(({item:t})=>[t.status==="active"||t.status==="inactive"?(b(),V(p,{key:0,onClick:_=>ie(t)},{default:l(()=>[a(A,{icon:"tabler-pencil",color:"warning"})]),_:2},1032,["onClick"])):k("",!0),t.status==="waiting_checker_approval"&&t.pending_action==="activate"||t.pending_action==="deactivate"&&t.checker_status===!0?(b(),V(p,{key:1},{default:l(()=>{var _,J;return[a(A,{icon:(_=W(t.status))==null?void 0:_.icon,color:(J=W(t.status))==null?void 0:J.color,title:t.status,onClick:He=>be([t.id])},null,8,["icon","color","title","onClick"])]}),_:2},1024)):k("",!0),t.status==="active"||t.status==="inactive"?(b(),V(p,{key:2},{default:l(()=>[a(A,{icon:"tabler-trash",color:"error",onClick:_=>ae(t)},null,8,["onClick"])]),_:2},1024)):k("",!0),t.checker_status===!0&&t.pending_action==="Email Template Created - Waiting Checker Approval"?(b(),V(p,{key:3},{default:l(()=>[a(A,{icon:"tabler-square-check",color:"success",onClick:_=>le(t)},null,8,["onClick"])]),_:2},1024)):k("",!0),t.checker_status===!0&&t.pending_action==="Email Template Created - Waiting Checker Approval"?(b(),V(p,{key:4},{default:l(()=>[a(A,{icon:"tabler-square-x",color:"error",onClick:_=>oe(t)},null,8,["onClick"])]),_:2},1024)):k("",!0),t.status==="inactive"&&t.pending_action===null?(b(),V(p,{key:5},{default:l(()=>[a(A,{icon:"tabler-thumb-down",color:"error",onClick:_=>se(t)},null,8,["onClick"])]),_:2},1024)):k("",!0),t.status==="active"&&t.pending_action===null?(b(),V(p,{key:6},{default:l(()=>[a(A,{icon:"tabler-thumb-up",color:"success",onClick:_=>ne(t)},null,8,["onClick"])]),_:2},1024)):k("",!0)]),bottom:l(()=>[a(Ee),f("div",Me,[f("p",Ne,T(o(we)({page:o(P),itemsPerPage:o(C)},o(M))),1),a(Se,{modelValue:o(P),"onUpdate:modelValue":e[5]||(e[5]=t=>v(P)?P.value=t:null),length:Math.ceil(o(M)/o(C)),"total-visible":s.$vuetify.display.xs?1:Math.min(Math.ceil(o(M)/o(C)),5),"active-color":"primary","next-icon":"tabler-caret-right","prev-icon":"tabler-caret-left"},null,8,["modelValue","length","total-visible"])])]),_:1},8,["items","items-per-page"])]),_:1}),o(x)?(b(),V(xe,{key:0,isDialogVisible:o(x),"onUpdate:isDialogVisible":e[6]||(e[6]=t=>v(x)?x.value=t:null),email:o(u)},null,8,["isDialogVisible","email"])):k("",!0),a(z,{modelValue:o(j),"onUpdate:modelValue":e[10]||(e[10]=t=>v(j)?j.value=t:null),persistent:"",class:"v-dialog-sm"},{default:l(()=>[a(F,{onClick:e[7]||(e[7]=t=>x.value=!o(x))}),a(E,null,{default:l(()=>[a(g,null,{default:l(()=>[r(" Are you sure you want to delete email template: "+T(o(u).name)+"? ",1),Oe,r(" This action can not be undone. ")]),_:1}),a(g,{class:"d-flex justify-end gap-3 flex-wrap"},{default:l(()=>[a(m,{color:"secondary",variant:"tonal",onClick:e[8]||(e[8]=t=>j.value=!1)},{default:l(()=>[r(" Cancel ")]),_:1}),a(m,{color:"error",onClick:e[9]||(e[9]=t=>ye(o(u).id))},{default:l(()=>[r(" Delete ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(z,{modelValue:o(w),"onUpdate:modelValue":e[14]||(e[14]=t=>v(w)?w.value=t:null),persistent:"",class:"v-dialog-sm"},{default:l(()=>[a(F,{onClick:e[11]||(e[11]=t=>w.value=!1)}),a(E,null,{default:l(()=>[a(g,null,{default:l(()=>[r(" Are you sure you want to Approve email template: "+T(o(u).name)+"? ",1),qe,r(" This action cannot be undone. ")]),_:1}),a(g,{class:"d-flex justify-end gap-3 flex-wrap"},{default:l(()=>[a(m,{color:"secondary",variant:"tonal",onClick:e[12]||(e[12]=t=>w.value=!1)},{default:l(()=>[r(" Cancel ")]),_:1}),a(m,{color:"success",onClick:e[13]||(e[13]=t=>de(o(u).id))},{default:l(()=>[r(" Approve ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(z,{modelValue:o(h),"onUpdate:modelValue":e[18]||(e[18]=t=>v(h)?h.value=t:null),persistent:"",class:"v-dialog-sm"},{default:l(()=>[a(F,{onClick:e[15]||(e[15]=t=>h.value=!1)}),a(E,null,{default:l(()=>[a(g,null,{default:l(()=>[r(" Are you sure you want to Reject this email template: "+T(o(u).name)+"? ",1),Ye,r(" This action cannot be undone. ")]),_:1}),a(g,{class:"d-flex justify-end gap-3 flex-wrap"},{default:l(()=>[a(m,{color:"secondary",variant:"tonal",onClick:e[16]||(e[16]=t=>h.value=!1)},{default:l(()=>[r(" Cancel ")]),_:1}),a(m,{color:"error",onClick:e[17]||(e[17]=t=>fe(o(u).id))},{default:l(()=>[r(" Reject ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(z,{modelValue:o(D),"onUpdate:modelValue":e[22]||(e[22]=t=>v(D)?D.value=t:null),persistent:"",class:"v-dialog-sm"},{default:l(()=>[a(F,{onClick:e[19]||(e[19]=t=>D.value=!1)}),a(E,null,{default:l(()=>[a(g,null,{default:l(()=>[r(" Are you sure you want to Enable this email template: "+T(o(u).name)+"? ",1),Qe,r(" This action cannot be undone. ")]),_:1}),a(g,{class:"d-flex justify-end gap-3 flex-wrap"},{default:l(()=>[a(m,{color:"secondary",variant:"tonal",onClick:e[20]||(e[20]=t=>D.value=!1)},{default:l(()=>[r(" Cancel ")]),_:1}),a(m,{color:"success",onClick:e[21]||(e[21]=t=>ve(o(u).id))},{default:l(()=>[r(" Enable ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(z,{modelValue:o($),"onUpdate:modelValue":e[26]||(e[26]=t=>v($)?$.value=t:null),persistent:"",class:"v-dialog-sm"},{default:l(()=>[a(F,{onClick:e[23]||(e[23]=t=>$.value=!1)}),a(E,null,{default:l(()=>[a(g,null,{default:l(()=>[r(" Are you sure you want to Disable this email template: "+T(o(u).name)+"? ",1),We,r(" This action cannot be undone. ")]),_:1}),a(g,{class:"d-flex justify-end gap-3 flex-wrap"},{default:l(()=>[a(m,{color:"secondary",variant:"tonal",onClick:e[24]||(e[24]=t=>$.value=!1)},{default:l(()=>[r(" Cancel ")]),_:1}),a(m,{color:"error",onClick:e[25]||(e[25]=t=>ge(o(u).id))},{default:l(()=>[r(" Disable ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}});export{Kt as default};
