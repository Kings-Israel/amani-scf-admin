import{r as _,e as q}from"./validators-db74a876.js";import{d as B,bX as M,r as i,k as $,l as F,o as N,h as U,f as r,b as s,e as n,p as e,J as j,a$ as D,aI as E,x as p,a4 as S,a as A}from"./index-75b434bc.js";import{_ as G}from"./AppTextField.vue_vue_type_script_setup_true_lang-93dc1e26.js";import{i as b}from"./index-4532b75c.js";import{u as w}from"./useGenerateImageVariant-5ebe84de.js";import{a as J,b as O,c as z,d as W}from"./auth-v2-login-illustration-light-7e097de0.js";import{a as X,b as Y}from"./misc-mask-light-1aeffaee.js";import{V as H}from"./VNodeRenderer-4fd8aaef.js";import{$ as K}from"./api-0c1dfdf3.js";import{V as v}from"./VImg-ba4b392a.js";import{V as c}from"./VCol-35b3d337.js";import{V as Q}from"./VCard-95c0d706.js";import{V as k}from"./VCardText-76f31582.js";import{V as Z}from"./VForm-e46f5921.js";import{V as y}from"./VRow-d6f20668.js";import{V as ee}from"./VCheckbox-e2d8e1ba.js";import"./helpers-681711bc.js";import"./form-2b416184.js";import"./VTextField-05e93cc8.js";/* empty css                   */import"./VCounter-3e4b236e.js";import"./transition-6afda34e.js";import"./VField-82993695.js";import"./easing-9f15041e.js";import"./VInput-b46333d7.js";import"./forwardRefs-8348545e.js";import"./index-97808f23.js";import"./index-2898f57d.js";/* empty css              */import"./createSimpleFunctional-4b3a0a39.js";import"./VAvatar-071125b9.js";import"./VCheckboxBtn-0f22f589.js";import"./VSelectionControl-e1264669.js";const ae={class:"position-relative bg-background rounded-lg w-100 ma-8 me-0"},oe={class:"d-flex align-center justify-center w-100 h-100"},se=n("h4",{class:"text-h4 mb-1"},[p(" Welcome to "),n("span",{class:"text-capitalize"}," Yofinvoice"),p("! 👋🏻 ")],-1),re=n("p",{class:"mb-0"}," Please sign-in to your account and start the adventure ",-1),te={class:"d-flex align-center flex-wrap justify-space-between mt-1 mb-4"},Ee=B({__name:"login",setup(le){const x=()=>{const o=document.cookie.split("; ");for(let a of o){const m=a.indexOf("="),g=m>-1?a.substr(0,m):a;document.cookie=`${g}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/`}},L=async()=>{if("caches"in window){const o=await caches.keys();await Promise.all(o.map(a=>caches.delete(a)))}};M(()=>{x(),L()});const I=w(W,z,O,J,!0),C=w(Y,X),d=i(!1),u=i(!1);$();const R=F(),V=i({email:void 0,password:void 0}),h=i(),t=i({email:"",password:""}),f=i(!1),T=async()=>{u.value=!0;try{(await K("/admin/auth/UI/login",{method:"POST",body:{email:t.value.email,password:t.value.password},onResponseError({response:a}){throw new Error(a._data.errors?a._data.errors.email||"Incorrect email or password.":"Login failed.")}})).message&&(b.success("Login successful! Redirecting..."),setTimeout(()=>{R.push({name:"two-steps",query:{email:t.value.email}})},300))}catch(o){console.error(o),b.error(o.message||"An error occurred during login. Please try again later.")}finally{u.value=!1}},P=()=>{var o;(o=h.value)==null||o.validate().then(({valid:a})=>{a&&T()})};return(o,a)=>{const m=G,g=A("RouterLink");return N(),U(y,{class:"auth-wrapper bg-surface","no-gutters":""},{default:r(()=>[s(c,{class:"d-none d-lg-flex",lg:"8"},{default:r(()=>[n("div",ae,[n("div",oe,[s(v,{src:e(I),class:"auth-illustration mt-16 mb-2","max-width":"505"},null,8,["src"])]),s(v,{src:e(C),class:"auth-footer-mask"},null,8,["src"])])]),_:1}),s(c,{class:"auth-card-v2 d-flex align-center justify-center",cols:"12",lg:"4"},{default:r(()=>[s(Q,{"max-width":500,class:"mt-12 mt-sm-0 pa-4",flat:""},{default:r(()=>[s(k,null,{default:r(()=>[s(e(H),{nodes:e(j).app.logo,class:"mb-6"},null,8,["nodes"]),se,re]),_:1}),s(k,null,{default:r(()=>[s(e(Z),{ref_key:"refVForm",ref:h,onSubmit:D(P,["prevent"])},{default:r(()=>[s(y,null,{default:r(()=>[s(c,{cols:"12"},{default:r(()=>[s(m,{modelValue:e(t).email,"onUpdate:modelValue":a[0]||(a[0]=l=>e(t).email=l),"error-messages":e(V).email,rules:["requiredValidator"in o?o.requiredValidator:e(_),"emailValidator"in o?o.emailValidator:e(q)],autofocus:"",label:"Email",placeholder:"user@yofinvoice.com",type:"email"},null,8,["modelValue","error-messages","rules"])]),_:1}),s(c,{cols:"12"},{default:r(()=>[s(m,{modelValue:e(t).password,"onUpdate:modelValue":a[1]||(a[1]=l=>e(t).password=l),"append-inner-icon":e(d)?"tabler-eye-off":"tabler-eye","error-messages":e(V).password,rules:["requiredValidator"in o?o.requiredValidator:e(_)],type:e(d)?"text":"password",label:"Password",placeholder:"············","onClick:appendInner":a[2]||(a[2]=l=>d.value=!e(d))},null,8,["modelValue","append-inner-icon","error-messages","rules","type"]),n("div",te,[s(ee,{modelValue:e(f),"onUpdate:modelValue":a[3]||(a[3]=l=>E(f)?f.value=l:null),label:"Remember me"},null,8,["modelValue"]),s(g,{to:{name:"forgot-password"},class:"text-primary ms-2 mb-1"},{default:r(()=>[p(" Forgot Password? ")]),_:1})]),s(S,{block:"",type:"submit",loading:e(u),disabled:e(u)},{default:r(()=>[p(" Login ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})}}});export{Ee as default};
